(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-50f813b4"],{"48b0":function(t,e,n){},"51e5":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"online_table",style:{height:t.screenHeight+"px"}},[n("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{data:t.data,props:t.defaultProps,"default-expand-all":"","filter-node-method":t.filterNode}})],1),n("div",{staticStyle:{float:"right",width:"80%",height:"630px"}},[n("el-button",{directives:[{name:"show",rawName:"v-show",value:t.flag,expression:"flag"}],staticClass:"el-icon-video-play",staticStyle:{"padding-left":"30px","font-size":"14px"},attrs:{type:"text",size:"mini"},on:{click:function(e){return t.handleResult()}}},[t._v("运行")]),n("el-button",{staticClass:"el-icon-magic-stick",staticStyle:{"padding-left":"10px","font-size":"14px"},attrs:{type:"text",size:"mini"},on:{click:function(e){return t.sqlFormat()}}},[t._v("格式化SQL")]),n("el-button",{staticClass:"el-icon-delete",staticStyle:{"padding-left":"10px","font-size":"14px"},attrs:{type:"text",size:"mini"},on:{click:function(e){return t.del()}}},[t._v("一键清空")]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.stmt,expression:"stmt"}],ref:"mycode",staticClass:"codesql",staticStyle:{border:"0","border-radius":"5px","background-color":"rgba(241,241,241,.98)",width:"100%",height:"30%",padding:"10px",resize:"none","font-size":"14px"},attrs:{placeholder:"请输入sql语句...",maxlength:"2000"},domProps:{value:t.stmt},on:{input:[function(e){e.target.composing||(t.stmt=e.target.value)},t.descInput]}}),n("div",{staticStyle:{width:"100%",height:"70%","margin-top":"15px"}},[n("el-tabs",{attrs:{type:"card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:"信息",name:"1"},domProps:{innerHTML:t._s(t.info)}},[t._v(t._s(t.info))]),n("el-tab-pane",{attrs:{label:"历史",name:"2"}},[n("el-table",{staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{height:"360",data:t.history,border:"","highlight-current-row":""}},[n("el-table-column",{attrs:{type:"index",align:"center",label:"序号",width:"50"}}),n("el-table-column",{attrs:{align:"center",label:"SQL(双击SQL粘贴至上方)"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[n("span",{staticClass:"link-type",on:{dblclick:function(e){return t.copyVale(r.sql)}}},[t._v(t._s(r.sql))])]}}])}),n("el-table-column",{attrs:{prop:"result",align:"center",label:"状态"}}),n("el-table-column",{attrs:{prop:"time",align:"center",label:"开始时间"}}),n("el-table-column",{attrs:{prop:"ms",align:"center",label:"耗时（ms）"}})],1)],1),t._l(t.editableTabs,(function(e){return n("el-tab-pane",{key:e.name,attrs:{label:e.title,name:e.name}},[n("el-table",{attrs:{data:e.selectList,height:"360"}},t._l(e.selectListTitle,(function(t){return n("el-table-column",{key:t,attrs:{prop:t,label:t}})})),1)],1)}))],2)],1)],1)])},i=[],a=(n("4de4"),n("d3b7"),n("159b"),n("a18c")),s=n("82b0"),o=n("ed08"),l=(n("0f7c"),n("a7be"),n("f6b6"),n("db05")),u=n.n(l),c=n("56b3");n("8c33"),n("31c5"),n("ffda"),n("9b74"),n("991c");var d={name:"experience",data:function(){return{filterText:"",data:[{}],defaultProps:{children:"children",label:"label"},remnant:2e3,stmt:"",editableTabs:[],flag:!0,selectList:[],selectListTitle:[],history:[],info:"",activeName:"1",screenHeight:document.body.clientHeight-80}},watch:{filterText:function(t){this.$refs.tree.filter(t)},screenHeight:function(t){if(!this.timer){this.screenHeight=t,this.timer=!0;var e=this;setTimeout((function(){e.timer=!1}),400)}}},mounted:function(){var t=this;this.getComp();var e=this;window.onresize=function(){return function(){window.screenHeight=document.body.clientHeight-80,e.screenHeight=window.screenHeight}()};var n="text/x-pgsql";this.editor=c.fromTextArea(this.$refs.mycode,{mode:n,indentWithTabs:!0,smartIndent:!0,lineNumbers:!0,matchBrackets:!0,autofocus:!0,extraKeys:{Ctrl:"autocomplete"},hintOptions:{completeSingle:!1},lineWrapping:!1,foldGutter:!0,autoCloseBrackets:!0,autoCloseTags:!0,matchTags:{bothTags:!0},styleSelectedText:!0,styleActiveLine:!0,autoRefresh:!0,highlightSelectionMatches:{minChars:2,trim:!0,style:"matchhighlight",showToken:!1}}),this.editor.on("inputRead",(function(){t.editor.showHint()}))},methods:{filterNode:function(t,e){return!t||-1!==e.label.indexOf(t)},getComp:function(){var t=this,e=sessionStorage.getItem("apply_all_cluster"),n=sessionStorage.getItem("affected_clusters"),r=sessionStorage.getItem("login_username");if(2==e&&0===n.length)a["c"].push("/404");else{var i={effectCluster:n,user_name:r};Object(s["g"])(i).then((function(e){if(200==e.code){for(var n in e.res)t.$set(t.data[0],n,e.res[n]);sessionStorage.setItem("ip",e.ip),sessionStorage.setItem("port",e.port),sessionStorage.setItem("db",e.db)}else 501==e.code?a["c"].push("/404"):Object(o["e"])(e.message,"error")}))}},descInput:function(){console.log(11);var t=this.editor.getValue().length;this.remnant=2e3-t},handleResult:function(){var t=this;if(this.flag=!1,!this.editor.getValue())return this.flag=!0,void Object(o["e"])("sql语句不能为空！","error");if(this.editor.getValue().length>2e3)return this.flag=!0,void Object(o["e"])("请输入2000字节以内的sql语句！","error");var e={text:this.editor.getValue(),ip:sessionStorage.getItem("ip"),port:sessionStorage.getItem("port"),db:sessionStorage.getItem("db")};Object(s["h"])(e).then((function(e){if(200==e.code){if(t.flag=!0,t.info=e.len,e.res_date.length>0){var n=[],r=e.res_date;r.forEach((function(t,e){var r={title:"结果"+(e+1),name:"'"+(e+3)+"'",selectList:t.arr,selectListTitle:t.title};n.push(r)})),t.editableTabs=n}else t.editableTabs=[];t.history=e.history,t.getComp()}}))},copyVale:function(t){this.editor.setValue(this.editor.getValue()+t)},sqlFormat:function(){this.editor.getValue(),this.editor.setValue(u.a.format("select * from test;"))},del:function(){this.editor.setValue("")}}},f=d,h=(n("7c59"),n("ed2c"),n("2877")),g=Object(h["a"])(f,r,i,!1,null,"9f34b596",null);e["default"]=g.exports},"7c59":function(t,e,n){"use strict";n("e7b7")},"82b0":function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"g",(function(){return a})),n.d(e,"h",(function(){return s})),n.d(e,"b",(function(){return o})),n.d(e,"o",(function(){return l})),n.d(e,"a",(function(){return u})),n.d(e,"k",(function(){return c})),n.d(e,"d",(function(){return d})),n.d(e,"f",(function(){return f})),n.d(e,"p",(function(){return h})),n.d(e,"i",(function(){return g})),n.d(e,"l",(function(){return p})),n.d(e,"e",(function(){return m})),n.d(e,"m",(function(){return b})),n.d(e,"n",(function(){return v})),n.d(e,"j",(function(){return x}));var r=n("b775");function i(t){return Object(r["a"])({url:"/user/Cluster/clusterList",method:"get",params:t})}function a(t){return Object(r["a"])({url:"/user/Cluster/getEffectComp",method:"post",data:t})}function s(t){return Object(r["a"])({url:"/user/Cluster/getExperience",method:"post",data:t})}function o(t){return Object(r["a"])({url:"/user/Cluster/getBackUpList",method:"get",params:t})}function l(t){return Object(r["a"])({url:"/user/Cluster/ifBackUp",method:"post",data:{id:t}})}function u(){return Object(r["a"])({url:"/user/Cluster/getAllMachine",method:"get",params:""})}function c(t){return Object(r["a"])({url:"/user/Cluster/getShards",method:"post",data:{id:t}})}function d(t){return Object(r["a"])({url:"/user/Cluster/getClusterNodesList",method:"post",data:{id:t}})}function f(t){return Object(r["a"])({url:"/user/Cluster/getEffectCluster",method:"post",data:t})}function h(t){return Object(r["a"])({url:"/user/Cluster/updateAssign",method:"post",data:t})}function g(t){return Object(r["a"])({url:"/user/Cluster/getNode",method:"post",data:t})}function p(t){return Object(r["a"])({url:"/user/Cluster/getStandbyNode",method:"post",data:t})}function m(t){return Object(r["a"])({url:"/user/Cluster/getClusterShards",method:"post",data:{id:t}})}function b(t){return Object(r["a"])({url:"/user/Cluster/getSwitcheOverList",method:"get",params:t})}function v(t){return Object(r["a"])({url:"/user/Cluster/getTaskList",method:"get",params:t})}function x(t){return Object(r["a"])({url:"/user/Cluster/getShardPrimary",method:"post",data:t})}},e7b7:function(t,e,n){},ed08:function(t,e,n){"use strict";n.d(e,"e",(function(){return i})),n.d(e,"d",(function(){return a})),n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return l}));n("53ca"),n("ac1f"),n("00b4"),n("5319"),n("4d63"),n("2c3e"),n("25f0"),n("d3b7"),n("4d90"),n("1276"),n("159b");var r=n("5c96");function i(t,e){return Object(r["Message"])({message:t,type:e,duration:2e3})}function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"确定执行此操作吗？",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"warning";return r["MessageBox"].confirm(t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:e,center:!0})}function s(t){var e=t.split("T");return e[0]+" "+e[1]}function o(){var t=new Date,e="-",n=":",r=t.getFullYear(),i=t.getMonth()+1,a=t.getDate(),s=t.getHours(),o=t.getMinutes(),l=t.getSeconds(),u=["星期一","星期二","星期三","星期四","星期五","星期六","星期天"];u[t.getDay()];i>=1&&i<=9&&(i="0"+i),a>=0&&a<=9&&(a="0"+a),s>=0&&s<=9&&(s="0"+s),o>=0&&o<=9&&(o="0"+o),l>=0&&l<=9&&(l="0"+l);var c=r+e+i+e+a+" "+s+n+o+n+l;return c}function l(t){var e=t.split("-"),n=e[0],r=e[1],i=e[2],a=new Date(n,r,0);a=a.getDate();var s=n,o=parseInt(r)+1;13==o&&(s=parseInt(s)+1,o=1);var l=i,u=new Date(s,o,0);u=u.getDate(),l>u&&(l=u),o<10&&(o="0"+o);var c=s+"-"+o+"-"+l;return c}},ed2c:function(t,e,n){"use strict";n("48b0")}}]);