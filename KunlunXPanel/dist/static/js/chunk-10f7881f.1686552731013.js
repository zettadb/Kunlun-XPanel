(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-10f7881f"],{"0ccb":function(e,t,a){var r=a("50c4"),i=a("1148"),n=a("1d80"),o=Math.ceil,s=function(e){return function(t,a,s){var l,c,u=String(n(t)),d=u.length,p=void 0===s?" ":String(s),g=r(a);return g<=d||""==p?u:(l=g-d,c=i.call(p,o(l/p.length)),c.length>l&&(c=c.slice(0,l)),e?u+c:c+u)}};e.exports={start:s(!1),end:s(!0)}},1148:function(e,t,a){"use strict";var r=a("a691"),i=a("1d80");e.exports="".repeat||function(e){var t=String(i(this)),a="",n=r(e);if(n<0||n==1/0)throw RangeError("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(a+=t);return a}},"333d":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[a("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},i=[];a("a9e3");Math.easeInOutQuad=function(e,t,a,r){return e/=r/2,e<1?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t)};var n=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function o(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function s(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function l(e,t,a){var r=s(),i=e-r,l=20,c=0;t="undefined"===typeof t?500:t;var u=function e(){c+=l;var s=Math.easeInOutQuad(c,r,i,t);o(s),c<t?n(e):a&&"function"===typeof a&&a()};u()}var c={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&l(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&l(0,800)}}},u=c,d=(a("d059"),a("2877")),p=Object(d["a"])(u,r,i,!1,null,"65877abe",null);t["a"]=p.exports},"4d90":function(e,t,a){"use strict";var r=a("23e7"),i=a("0ccb").start,n=a("9a0c");r({target:"String",proto:!0,forced:n},{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},"9a0c":function(e,t,a){var r=a("342f");e.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r)},a15b:function(e,t,a){"use strict";var r=a("23e7"),i=a("44ad"),n=a("fc6a"),o=a("a640"),s=[].join,l=i!=Object,c=o("join",",");r({target:"Array",proto:!0,forced:l||!c},{join:function(e){return s.call(n(this),void 0===e?",":e)}})},b85c:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("fb6a"),a("25f0"),a("b0c0"),a("a630"),a("ac1f"),a("00b4");function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function i(e,t){if(e){if("string"===typeof e)return r(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?r(e,t):void 0}}function n(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=i(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==a["return"]||a["return"]()}finally{if(l)throw o}}}}},bbec:function(e,t,a){},d059:function(e,t,a){"use strict";a("bbec")},ed08:function(e,t,a){"use strict";a.d(t,"g",(function(){return i})),a.d(t,"f",(function(){return n})),a.d(t,"b",(function(){return o})),a.d(t,"d",(function(){return s})),a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"e",(function(){return u}));a("53ca"),a("ac1f"),a("00b4"),a("5319"),a("4d63"),a("2c3e"),a("25f0"),a("d3b7"),a("4d90"),a("159b"),a("b64b");var r=a("5c96");function i(e,t){return Object(r["Message"])({message:e,type:t,duration:2e3})}function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"确定执行此操作吗？",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"warning";return r["MessageBox"].confirm(e,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:t,center:!0})}function o(e){var t=e.split("T");return t[0]+" "+t[1]}function s(){var e=new Date,t="-",a=":",r=e.getFullYear(),i=e.getMonth()+1,n=e.getDate(),o=e.getHours(),s=e.getMinutes(),l=e.getSeconds(),c=["星期一","星期二","星期三","星期四","星期五","星期六","星期天"];c[e.getDay()];i>=1&&i<=9&&(i="0"+i),n>=0&&n<=9&&(n="0"+n),o>=0&&o<=9&&(o="0"+o),s>=0&&s<=9&&(s="0"+s),l>=0&&l<=9&&(l="0"+l);var u=r+t+i+t+n+" "+o+a+s+a+l;return u}function l(e){var t=e.split("-"),a=t[0],r=t[1],i=t[2],n=new Date(a,r,0);n=n.getDate();var o=a,s=parseInt(r)+1;13==s&&(o=parseInt(o)+1,s=1);var l=i,c=new Date(o,s,0);c=c.getDate(),l>c&&(l=c),s<10&&(s="0"+s);var u=o+"-"+s+"-"+l;return u}function c(){for(var e="",t=4,a=new Array(0,1,2,3,4,5,6,7,8,9),r=0;r<t;r++){var i=Math.floor(9*Math.random());e+=a[i]}return e}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"确定执行此操作吗？",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"warning";return r["MessageBox"].prompt(e,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"请输入code",inputPattern:/^[0-9]\d*$/,inputErrorMessage:"code格式不正确",type:t})}},f982:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("div",{directives:[{name:"show",rawName:"v-show",value:"Y"===e.role_add_priv,expression:"role_add_priv==='Y'"}],staticClass:"table-list-wrap"},[a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("新增 ")])],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.list,border:"","highlight-current-row":""}},[e._v(" > "),a("el-table-column",{attrs:{type:"index",align:"center",label:"序号",width:"50"}}),a("el-table-column",{attrs:{label:"角色名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",{staticClass:"link-type",on:{click:function(t){return e.handleDetail(r)}}},[e._v(e._s(r.role_name))])]}}])}),a("el-table-column",{attrs:{prop:"priv",align:"center","show-overflow-tooltip":!0,label:"拥有权限"}}),a("el-table-column",{attrs:{prop:"update_time",align:"center",label:"更新时间"}}),"Y"===e.role_edit_priv&&"Y"===e.role_drop_priv?a("el-table-column",{attrs:{label:"操作",align:"center",width:"230","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row,i=t.$index;return[a("el-button",{directives:[{name:"show",rawName:"v-show",value:"Y"===e.role_edit_priv&&"super_dba"!==r.role_name,expression:"role_edit_priv==='Y'&&row.role_name!=='super_dba'"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleUpdate(r)}}},[e._v("编辑 ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"Y"===e.role_drop_priv&&"super_dba"!==r.role_name,expression:"role_drop_priv==='Y'&&row.role_name!=='super_dba'"}],attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(r,i)}}},[e._v("删除 ")])]}}],null,!1,2553206638)}):e._e()],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.pageNo,limit:e.listQuery.pageSize},on:{"update:page":function(t){return e.$set(e.listQuery,"pageNo",t)},"update:limit":function(t){return e.$set(e.listQuery,"pageSize",t)},pagination:e.getList}}),a("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,"custom-class":"single_dal_view"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"dataForm",attrs:{rules:e.rules,model:e.temp,"label-position":"left","label-width":"110px"}},[a("el-form-item",{attrs:{label:"角色名称:",prop:"role_name"}},[a("el-input",{attrs:{placeholder:"请输入角色名称",disabled:"detail"===e.dialogStatus||"super_dba"==e.temp.role_name},model:{value:e.temp.role_name,callback:function(t){e.$set(e.temp,"role_name",t)},expression:"temp.role_name"}})],1),a("el-form-item",{attrs:{label:"拥有权限:",prop:"checkkeys",disabled:"detail"===e.dialogStatus}},[a("el-tree",{ref:"tree",attrs:{data:e.datatree,"show-checkbox":"","node-key":"id","default-expanded-keys":[3],"default-checked-keys":e.checkkeys,props:e.defaultProps1}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.dialogDetail,expression:"!dialogDetail"}],on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("关闭")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.dialogDetail,expression:"!dialogDetail"}],attrs:{type:"primary"},on:{click:function(t){"create"===e.dialogStatus?e.createData():e.updateData(e.row)}}},[e._v(" 确认 ")])],1)],1)],1)},i=[],n=a("b85c"),o=a("c7eb"),s=a("1da1"),l=(a("b64b"),a("a15b"),a("d3b7"),a("25f0"),a("ed08")),c=a("3528"),u=a("333d"),d=a("578a"),p={name:"Role",components:{Pagination:u["a"]},data:function(){return{tableKey:0,list:null,listLoading:!0,total:0,listQuery:{pageNo:1,pageSize:10},temp:{role_name:"",priv:{}},dialogFormVisible:!1,dialogEditVisible:!1,dialogStatus:"",textMap:{update:"编辑角色",create:"新增角色",detail:"详情",grant:"授权"},dialogDetail:!1,message_tips:"",message_type:"",role_type_data:d["p"],valid_period_data:d["t"],priv_type_arr:d["o"],checkedGrant:[],rolesData:[],role_add_priv:JSON.parse(sessionStorage.getItem("priv")).role_add_priv,role_drop_priv:JSON.parse(sessionStorage.getItem("priv")).role_drop_priv,role_edit_priv:JSON.parse(sessionStorage.getItem("priv")).role_edit_priv,row:{},datatree:d["f"],defaultProps1:{children:"children",label:"label"},rules:{role_name:[{required:!0,message:"请输入角色名称!",trigger:"blur"}]},rolId:"",routesData:[],checkedNodes:[],defaultProps:{children:"children",label:"slotTitle"},routes:[],checkkeys:[]}},created:function(){this.getList()},methods:{getList:function(){var e=this;this.listLoading=!0;var t=Object.assign({},this.listQuery);t.user_name=sessionStorage.getItem("login_username"),t.roleName="*".concat(this.listQuery.roleName,"*"),Object(c["f"])(t).then((function(t){for(var a=t.list,r=0;r<a.length;r++){var i="";"Y"==a[r].backup_priv&&(i+="备份集群,"),"Y"==a[r].cluster_creata_priv&&(i+="新增集群,"),"Y"==a[r].cluster_drop_priv&&(i+="删除集群,"),"Y"==a[r].compute_disable_priv&&"Y"==a[r].compute_enable_priv&&(i+="启/禁用计算节点,"),"Y"==a[r].compute_node_create_priv&&(i+="新增计算节点,"),"Y"==a[r].compute_node_drop_priv&&(i+="删除计算节点,"),"Y"==a[r].machine_add_priv&&(i+="新增计算机,"),"Y"==a[r].machine_drop_priv&&(i+="删除计算机,"),"Y"==a[r].machine_priv&&(i+="编辑计算机,"),"Y"==a[r].restore_priv&&(i+="恢复集群,"),"Y"==a[r].role_add_priv&&(i+="新增角色,"),"Y"==a[r].role_drop_priv&&(i+="删除角色,"),"Y"==a[r].role_edit_priv&&(i+="编辑角色,"),"Y"==a[r].shard_create_priv&&(i+="新增存储shard,"),"Y"==a[r].shard_drop_priv&&(i+="删除存储shard,"),"Y"==a[r].shrink_cluster_priv&&(i+="集群缩容,"),"Y"==a[r].expand_cluster_priv&&(i+="集群扩容,"),"Y"==a[r].backup_service_disable_priv&&"Y"==a[r].backup_service_enable_priv&&(i+="启/禁用备份服务,"),"Y"==a[r].storage_disable_priv&&"Y"==a[r].storage_enable_priv&&(i+="启/禁用存储节点,"),"Y"==a[r].storage_node_create_priv&&(i+="新增存储节点,"),"Y"==a[r].storage_node_drop_priv&&(i+="删除存储节点,"),"Y"==a[r].user_add_priv&&(i+="新增用户,"),"Y"==a[r].user_drop_priv&&(i+="删除用户,"),"Y"==a[r].user_edit_priv&&(i+="编辑用户,"),"Y"==a[r].user_grant_priv&&(i+="用户授权,"),i=i.substring(0,i.length-1),e.$set(a[r],"priv",i)}e.list=a,e.total=t.total,setTimeout((function(){e.listLoading=!1}),500)}))},resetTemp:function(){this.temp={role_name:"",priv:{}}},handleCreate:function(){var e=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.dialogDetail=!1,this.$nextTick((function(){e.$refs.dataForm.clearValidate(),e.$refs.tree.setCheckedKeys([])}))},createData:function(){var e=this,t=this.$refs.tree.getCheckedKeys(),a={permissionIds:t.join(",")};this.temp.priv=a,this.$refs["dataForm"].validate((function(t){t&&Object(c["a"])(e.temp).then((function(t){var a=t;200==a.code?(e.getList(),e.dialogFormVisible=!1,e.message_tips="新增成功",e.message_type="success"):(e.message_tips=a.message,e.message_type="error"),Object(l["g"])(e.message_tips,e.message_type)}))}))},handleDetail:function(e){var t=this;this.dialogStatus="detail",this.dialogFormVisible=!0,this.temp=Object.assign({},e),this.dialogDetail=!0,Object(c["e"])(e.id).then((function(e){t.checkkeys=e.list[0].checkkeys,t.$nextTick((function(){t.$refs.tree.setCheckedKeys(t.checkkeys)}))}))},handleUpdate:function(e){var t=this;Object(c["e"])(e.id).then((function(e){t.checkkeys=e.list[0].checkkeys,t.dialogEditVisible=!0,t.$nextTick((function(){t.$refs.tree.setCheckedKeys(t.checkkeys)}))})),this.temp=Object.assign({},e),this.temp.id=e.id,this.dialogStatus="update",this.dialogFormVisible=!0,this.dialogDetail=!1,this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))},updateData:function(e){var t=this;this.$refs["dataForm"].validate((function(e){if(e){var a=t.$refs.tree.getCheckedKeys(),r={permissionIds:a.join(",")};t.temp.priv=r;var i=Object.assign({},t.temp);console.log(i),Object(c["g"])(i).then((function(e){var a=e;200==a.code?(t.dialogFormVisible=!1,t.message_tips="编辑成功",t.message_type="success",t.getList()):(t.message_tips=a.message,t.message_type="error"),Object(l["g"])(t.message_tips,t.message_type)}))}}))},handleDelete:function(e){var t=this;Object(l["f"])("此操作将永久删除该数据, 是否继续?").then((function(){Object(c["b"])(e.id).then((function(e){var a=e;200==a.code?(t.dialogFormVisible=!1,t.message_tips="删除成功",t.message_type="success",t.getList()):(t.message_tips=a.message,t.message_type="error"),Object(l["g"])(t.message_tips,t.message_type)}))})).catch((function(){console.log("quxiao"),Object(l["g"])("已取消删除","info")}))},handleEdit:function(e){var t=this;this.resetTemp(),this.dialogStatus="grant",this.dialogFormVisible=!0,this.dialogDetail=!1,this.$nextTick((function(){t.$refs.dataForm.clearValidate()}))},savePermission:function(){var e=this,t=this.$refs.tree.getCheckedKeys(),a={roleId:this.rolId,permissionIds:t.join(","),lastpermissionIds:this.checkedNodes.join(",")};console.log(a),saveRolePermission(a).then((function(t){var a=t;200==a.code?(e.getList(),e.dialogEditVisible=!1,e.message_tips="编辑成功",e.message_type="success"):(e.message_tips=a.message,e.message_type="error"),Object(l["g"])(e.message_tips,e.message_type)}))},getRoutes:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){var e=this;return Object(s["a"])(Object(o["a"])().mark((function t(){var a;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,getRoutes();case 2:a=t.sent,e.routesData=getTreeData(a.result.treeList);case 4:case"end":return t.stop()}}),t)})))()})),handleRoleType:function(e){var t,a="",r=Object(n["a"])(d["p"]);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(e.role_name==i["value"]){a=i["label"];break}a=e.role_name}}catch(o){r.e(o)}finally{r.f()}return a},handleEffectTime:function(e){var t,a="",r=Object(n["a"])(d["t"]);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(e.valid_period==i["value"]){a=i["label"];break}a=e.valid_period}}catch(o){r.e(o)}finally{r.f()}return a},handleStartTime:function(e){var t="";return t="0000-00-00 00:00:00"==e.start_ts?"":e.start_ts,t},handleEndTime:function(e){var t="";return t="0000-00-00 00:00:00"==e.end_ts?"":e.end_ts,t},formatDataTimeTotime:function(e){return Object(l["b"])(e)}}},g=p,f=a("2877"),m=Object(f["a"])(g,r,i,!1,null,null,null);t["default"]=m.exports}}]);