(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-54f58294"],{"0ac5":function(t,e,s){"use strict";s("ea1d")},"333d":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pagination-container",class:{hidden:t.hidden}},[s("el-pagination",t._b({attrs:{background:t.background,"current-page":t.currentPage,"page-size":t.pageSize,layout:t.layout,"page-sizes":t.pageSizes,total:t.total},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},"el-pagination",t.$attrs,!1))],1)},a=[];s("a9e3");Math.easeInOutQuad=function(t,e,s,i){return t/=i/2,t<1?s/2*t*t+e:(t--,-s/2*(t*(t-2)-1)+e)};var r=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function o(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function n(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function c(t,e,s){var i=n(),a=t-i,c=20,l=0;e="undefined"===typeof e?500:e;var u=function t(){l+=c;var n=Math.easeInOutQuad(l,i,a,e);o(n),l<e?r(t):s&&"function"===typeof s&&s()};u()}var l={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit("update:page",t)}},pageSize:{get:function(){return this.limit},set:function(t){this.$emit("update:limit",t)}}},methods:{handleSizeChange:function(t){this.$emit("pagination",{page:this.currentPage,limit:t}),this.autoScroll&&c(0,800)},handleCurrentChange:function(t){this.$emit("pagination",{page:t,limit:this.pageSize}),this.autoScroll&&c(0,800)}}},u=l,d=(s("d059"),s("2877")),p=Object(d["a"])(u,i,a,!1,null,"65877abe",null);e["a"]=p.exports},"82b0":function(t,e,s){"use strict";s.d(e,"z",(function(){return a})),s.d(e,"I",(function(){return r})),s.d(e,"L",(function(){return o})),s.d(e,"k",(function(){return n})),s.d(e,"l",(function(){return c})),s.d(e,"f",(function(){return l})),s.d(e,"v",(function(){return u})),s.d(e,"lb",(function(){return d})),s.d(e,"pb",(function(){return p})),s.d(e,"t",(function(){return h})),s.d(e,"ab",(function(){return m})),s.d(e,"d",(function(){return _})),s.d(e,"b",(function(){return f})),s.d(e,"c",(function(){return g})),s.d(e,"J",(function(){return b})),s.d(e,"B",(function(){return v})),s.d(e,"n",(function(){return L})),s.d(e,"m",(function(){return w})),s.d(e,"o",(function(){return j})),s.d(e,"ub",(function(){return O})),s.d(e,"vb",(function(){return y})),s.d(e,"wb",(function(){return k})),s.d(e,"xb",(function(){return C})),s.d(e,"nb",(function(){return S})),s.d(e,"ob",(function(){return x})),s.d(e,"H",(function(){return I})),s.d(e,"Ab",(function(){return P})),s.d(e,"S",(function(){return V})),s.d(e,"eb",(function(){return $})),s.d(e,"gb",(function(){return N})),s.d(e,"hb",(function(){return T})),s.d(e,"Y",(function(){return D})),s.d(e,"fb",(function(){return M})),s.d(e,"E",(function(){return z})),s.d(e,"w",(function(){return F})),s.d(e,"yb",(function(){return R})),s.d(e,"a",(function(){return B})),s.d(e,"e",(function(){return E})),s.d(e,"Cb",(function(){return Q})),s.d(e,"p",(function(){return A})),s.d(e,"mb",(function(){return q})),s.d(e,"cb",(function(){return J})),s.d(e,"bb",(function(){return U})),s.d(e,"F",(function(){return H})),s.d(e,"T",(function(){return K})),s.d(e,"U",(function(){return W})),s.d(e,"x",(function(){return G})),s.d(e,"g",(function(){return Y})),s.d(e,"db",(function(){return Z})),s.d(e,"C",(function(){return X})),s.d(e,"D",(function(){return tt})),s.d(e,"Z",(function(){return et})),s.d(e,"W",(function(){return st})),s.d(e,"s",(function(){return it})),s.d(e,"K",(function(){return at})),s.d(e,"qb",(function(){return rt})),s.d(e,"O",(function(){return ot})),s.d(e,"P",(function(){return nt})),s.d(e,"u",(function(){return ct})),s.d(e,"sb",(function(){return lt})),s.d(e,"jb",(function(){return ut})),s.d(e,"kb",(function(){return dt})),s.d(e,"V",(function(){return pt})),s.d(e,"i",(function(){return ht})),s.d(e,"tb",(function(){return mt})),s.d(e,"R",(function(){return _t})),s.d(e,"rb",(function(){return ft})),s.d(e,"q",(function(){return gt})),s.d(e,"j",(function(){return bt})),s.d(e,"ib",(function(){return vt})),s.d(e,"A",(function(){return Lt})),s.d(e,"zb",(function(){return wt})),s.d(e,"X",(function(){return jt})),s.d(e,"h",(function(){return Ot})),s.d(e,"G",(function(){return yt})),s.d(e,"M",(function(){return kt})),s.d(e,"N",(function(){return Ct})),s.d(e,"Bb",(function(){return St})),s.d(e,"r",(function(){return xt})),s.d(e,"y",(function(){return It})),s.d(e,"Q",(function(){return Pt}));var i=s("b775");function a(t){return Object(i["a"])({url:"/user/Cluster/clusterList",method:"get",params:t})}function r(t){return Object(i["a"])({url:"/user/Cluster/getEffectComp",method:"post",data:t})}function o(t){return Object(i["a"])({url:"/user/Cluster/getExperience",method:"post",data:t})}function n(t){return Object(i["a"])({url:"/user/Cluster/createCluster",method:"post",data:t})}function c(t){return Object(i["a"])({url:"/user/Cluster/delCluster",method:"post",data:t})}function l(t){return Object(i["a"])({url:"/user/Cluster/backUpCluster",method:"post",data:t})}function u(t){return Object(i["a"])({url:"/user/Cluster/getBackUpList",method:"get",params:t})}function d(t){return Object(i["a"])({url:"/user/Cluster/ifBackUp",method:"post",data:{id:t}})}function p(t){return Object(i["a"])({url:"/user/Cluster/restoreCluster",method:"post",data:t})}function h(){return Object(i["a"])({url:"/user/Cluster/getAllMachine",method:"get",params:""})}function m(t){return Object(i["a"])({url:"/user/Cluster/getShards",method:"post",data:{id:t}})}function _(t){return Object(i["a"])({url:"/user/Cluster/addShards",method:"post",data:t})}function f(t){return Object(i["a"])({url:"/user/Cluster/addComps",method:"post",data:t})}function g(t){return Object(i["a"])({url:"/user/Cluster/addNodes",method:"post",data:t})}function b(t){return Object(i["a"])({url:"/user/Cluster/getStatus",method:"post",data:t})}function v(t){return Object(i["a"])({url:"/user/Cluster/getClusterNodesList",method:"post",data:t})}function L(t){return Object(i["a"])({url:"/user/Cluster/delShard",method:"post",data:t})}function w(t){return Object(i["a"])({url:"/user/Cluster/delComp",method:"post",data:t})}function j(t){return Object(i["a"])({url:"/user/Cluster/delSnode",method:"post",data:t})}function O(t){return Object(i["a"])({url:"/user/Cluster/controlInstance",method:"post",data:t})}function y(t){return Object(i["a"])({url:"/user/Cluster/controlInstance",method:"post",data:t})}function k(t){return Object(i["a"])({url:"/user/Cluster/controlInstance",method:"post",data:t})}function C(t){return Object(i["a"])({url:"/user/Cluster/controlInstance",method:"post",data:t})}function S(t){return Object(i["a"])({url:"/user/Cluster/controlInstance",method:"post",data:t})}function x(t){return Object(i["a"])({url:"/user/Cluster/controlInstance",method:"post",data:t})}function I(t){return Object(i["a"])({url:"/user/Cluster/getEffectCluster",method:"post",data:t})}function P(t){return Object(i["a"])({url:"/user/Cluster/updateAssign",method:"post",data:t})}function V(t){return Object(i["a"])({url:"/user/Cluster/getNode",method:"post",data:t})}function $(t){return Object(i["a"])({url:"/user/Cluster/getStandbyNode",method:"post",data:t})}function N(t){return Object(i["a"])({url:"/user/Cluster/getSwitcheOverList",method:"get",params:t})}function T(t){return Object(i["a"])({url:"/user/Cluster/getTaskList",method:"get",params:t})}function D(t){return Object(i["a"])({url:"/user/Cluster/getShardPrimary",method:"post",data:t})}function M(){return Object(i["a"])({url:"/user/Cluster/getStroMachine",method:"get",params:""})}function z(){return Object(i["a"])({url:"/user/Cluster/getCompMachine",method:"get",params:""})}function F(t){return Object(i["a"])({url:"/user/Cluster/getBackUpStorage",method:"post",data:t})}function R(t){return Object(i["a"])({url:"/user/Cluster/switchShard",method:"post",data:t})}function B(t){return Object(i["a"])({url:"/user/Cluster/SetCpuCgroup",method:"post",data:t})}function E(t){return Object(i["a"])({url:"/user/Cluster/addStorage",method:"post",data:t})}function Q(t){return Object(i["a"])({url:"/user/Cluster/updateStorage",method:"post",data:t})}function A(t){return Object(i["a"])({url:"/user/Cluster/delStorage",method:"post",data:t})}function q(t){return Object(i["a"])({url:"/user/Cluster/rebuildNode",method:"post",data:t})}function J(t){return Object(i["a"])({url:"/user/Cluster/getShardsJobLog",method:"post",data:t})}function U(t){return Object(i["a"])({url:"/user/Cluster/getShardsCount",method:"get",params:t})}function H(t){return Object(i["a"])({url:"/user/Cluster/getCompsCount",method:"get",params:t})}function K(t){return Object(i["a"])({url:"/user/Cluster/getNodesCount",method:"get",params:t})}function W(t){return Object(i["a"])({url:"/user/Cluster/getOldCluster",method:"get",params:t})}function G(){return Object(i["a"])({url:"/user/Cluster/getBackupStorageList",method:"get",params:""})}function Y(t){return Object(i["a"])({url:"/user/Cluster/clusterListError",method:"get",params:t})}function Z(t){return Object(i["a"])({url:"/user/Cluster/getShardsName",method:"get",params:t})}function X(t){return Object(i["a"])({url:"/user/Cluster/getCompDBName",method:"get",params:t})}function tt(t){return Object(i["a"])({url:"/user/Cluster/getCompDBTable",method:"get",params:t})}function et(t){return Object(i["a"])({url:"/user/Cluster/getShardTable",method:"get",params:t})}function st(t){return Object(i["a"])({url:"/user/Cluster/getOtherShards",method:"get",params:t})}function it(t){return Object(i["a"])({url:"/user/Cluster/expandCluster",method:"post",data:t})}function at(t){return Object(i["a"])({url:"/user/Cluster/getExpandTableList",method:"post",data:t})}function rt(t){return Object(i["a"])({url:"/user/Cluster/setMaxDalay",method:"post",data:t})}function ot(t){return Object(i["a"])({url:"/user/Cluster/getMaxDalay",method:"post",data:t})}function nt(t){return Object(i["a"])({url:"/user/Cluster/getMetaCluster",method:"get",params:t})}function ct(t){return Object(i["a"])({url:"/user/Cluster/getBackStorageList",method:"get",params:t})}function lt(t){return Object(i["a"])({url:"/user/Cluster/setVariable",method:"post",data:t})}function ut(t){return Object(i["a"])({url:"/user/Cluster/getVariable",method:"post",data:t})}function dt(t){return Object(i["a"])({url:"/user/Cluster/getWorkMode",method:"post",data:t})}function pt(t){return Object(i["a"])({url:"/user/Cluster/getOneBackUpList",method:"get",params:t})}function ht(t){return Object(i["a"])({url:"/user/Cluster/computeList",method:"get",params:t})}function mt(t){return Object(i["a"])({url:"/user/Cluster/shardList",method:"get",params:t})}function _t(t){return Object(i["a"])({url:"/user/Cluster/getNoSwitchList",method:"post",data:t})}function ft(t){return Object(i["a"])({url:"/user/Cluster/setNoSwitch",method:"post",data:t})}function gt(t){return Object(i["a"])({url:"/user/Cluster/delSwitch",method:"post",data:t})}function bt(t){return Object(i["a"])({url:"/user/Cluster/controlInstance",method:"post",data:t})}function vt(t){return Object(i["a"])({url:"/user/Cluster/getThisShardNodes",method:"post",data:t})}function Lt(t){return Object(i["a"])({url:"/user/Cluster/getClusterMonitor",method:"get",params:t})}function wt(t){return Object(i["a"])({url:"/user/ClusterSetting/tableRepartition",method:"post",data:t})}function jt(t){return Object(i["a"])({url:"/user/ClusterSetting/getPGTableList",method:"get",params:t})}function Ot(t){return Object(i["a"])({url:"/user/ClusterSetting/clusterOptions",method:"get",params:t})}function yt(t){return Object(i["a"])({url:"/user/ClusterSetting/getDataCenters",method:"get",params:t})}function kt(t){return Object(i["a"])({url:"/user/Cluster/getLogicalBackUpList",method:"get",params:t})}function Ct(t){return Object(i["a"])({url:"/user/ClusterSetting/getRecordLogicalBackup",method:"get",params:t})}function St(t){return Object(i["a"])({url:"/user/Cluster/updateShard",method:"post",data:t})}function xt(t){return Object(i["a"])({url:"/user/Cluster/cdcEdit",method:"post",data:t})}function It(t){return Object(i["a"])({url:"/user/Cluster/getCdcList",method:"post",data:t})}function Pt(t){return Object(i["a"])({url:"/user/MetaCluster/getMetaClusterList",method:"get",params:t})}},bbec:function(t,e,s){},cd35:function(t,e,s){},d059:function(t,e,s){"use strict";s("bbec")},ddd0:function(t,e,s){"use strict";s("cd35")},ea1d:function(t,e,s){},eb5a:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-container"},[s("div",{staticClass:"filter-container"},[s("div",{staticClass:"table-list-search-wrap"},[s("el-input",{staticClass:"list_search_keyword",attrs:{placeholder:"可输入IP搜索"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleFilter(e)}},model:{value:t.listQuery.hostaddr,callback:function(e){t.$set(t.listQuery,"hostaddr",e)},expression:"listQuery.hostaddr"}}),s("el-button",{attrs:{icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v(" 查询 ")]),s("el-button",{attrs:{icon:"el-icon-refresh-right"},on:{click:t.handleClear}},[t._v(" 重置 ")]),"rbr"===t.meta_ha_mode?s("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:t.handleSwitch}},[s("i",{staticClass:"el-icon-sort",staticStyle:{transform:"rotate(90deg)"}}),t._v("主备切换")]):t._e(),"rbr"===t.meta_ha_mode?s("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-copy-document"},on:{click:t.handleRedo}},[t._v("重做备机")]):t._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:!0===t.installStatus,expression:"installStatus === true"}],staticClass:"info",domProps:{textContent:t._s(t.info)}})],1)]),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],key:t.tableKey,staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:t.list,border:"","highlight-current-row":""}},[s("el-table-column",{attrs:{type:"index",align:"center",label:"序号",width:"50"}}),s("el-table-column",{attrs:{label:"IP",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[s("span",{staticClass:"link-type",on:{click:function(e){return t.handleDetail(i)}}},[t._v(t._s(i.hostaddr))])]}}])}),s("el-table-column",{attrs:{prop:"port",label:"端口",align:"center"}}),s("el-table-column",{attrs:{align:"center",label:"高可用模式"}},[[s("span",[t._v(t._s(t.meta_ha_mode))])]],2),s("el-table-column",{attrs:{align:"center",label:"节点状态"},scopedSlots:t._u([{key:"default",fn:function(e){return["source"===e.row.member_state?s("span",[t._v("主节点")]):"replica"==e.row.member_state?s("span",[t._v("备机节点")]):s("span")]}}])}),s("el-table-column",{attrs:{align:"center",label:"同步状态"},scopedSlots:t._u([{key:"default",fn:function(e){return["fsync"===e.row.sync_state?s("span",[t._v("同步")]):"async"==e.row.sync_state?s("span",[t._v("异步")]):s("span")]}}])}),s("el-table-column",{attrs:{prop:"replica_delay",align:"center",label:"主备延迟时间(s)"}})],1),s("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total > 0"}],attrs:{total:t.total,page:t.listQuery.pageNo,limit:t.listQuery.pageSize},on:{"update:page":function(e){return t.$set(t.listQuery,"pageNo",e)},"update:limit":function(e){return t.$set(t.listQuery,"pageSize",e)},pagination:t.getList}}),s("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogNodeVisible,"custom-class":"single_dal_view","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogNodeVisible=e}}},[s("el-form",{ref:"nodeForm",attrs:{model:t.nodetemp,rules:t.rules,"label-position":"left","label-width":"110px"}},["update"===t.dialogStatus?s("el-form-item",{attrs:{label:"选择计算机:",prop:"machinelist"}},[s("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:t.nodetemp.machinelist,callback:function(e){t.$set(t.nodetemp,"machinelist",e)},expression:"nodetemp.machinelist"}},t._l(t.strogemachines,(function(t){return s("el-option",{key:t.id,attrs:{label:t.hostaddr,value:t.hostaddr}})})),1)],1):t._e(),s("el-form-item",{attrs:{label:"节点个数:",prop:"nodes"}},[s("el-input",{staticClass:"right_input",attrs:{placeholder:"请输入节点个数",disabled:"detail"===t.dialogStatus},model:{value:t.nodetemp.nodes,callback:function(e){t.$set(t.nodetemp,"nodes",e)},expression:"nodetemp.nodes"}},[s("i",{staticStyle:{"font-style":"normal","margin-right":"10px","line-height":"30px"},attrs:{slot:"suffix"},slot:"suffix"},[t._v("个")])])],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dialogNodeVisible=!1}}},[t._v("关闭")]),s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.updateData(t.row)}}},[t._v("确认")])],1)],1),s("el-dialog",{attrs:{visible:t.dialogStatusVisible,"custom-class":"single_dal_view",width:"400px","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogStatusVisible=e}}},[s("div",{staticClass:"block"},[s("el-timeline",t._l(t.activities,(function(e,i){return s("el-timeline-item",{key:i,attrs:{icon:e.icon,type:e.type,color:e.color,size:e.size,timestamp:e.timestamp}},[t._v(" "+t._s(e.content)+" ")])})),1)],1)]),s("el-dialog",{attrs:{title:t.job_id,visible:t.dialogStatusShowVisible,"custom-class":"single_dal_view","close-on-click-modal":!1,"before-close":t.beforeDestory},on:{"update:visible":function(e){t.dialogStatusShowVisible=e}}},[s("div",{staticStyle:{width:"100%",background:"#fff",padding:"0 20px"}},[s("el-steps",{attrs:{direction:"vertical",active:t.init_active}},[t.init_show?s("el-step",{attrs:{title:t.init_title,icon:"el-icon-more"}}):t._e(),t.computer_show?s("el-step",{attrs:{title:t.computer_title,status:t.computer_state,icon:t.computer_icon,description:t.computer_description}},[s("template",{slot:"description"},[s("span",[t._v(t._s(t.computer_description))]),s("div",{staticStyle:{padding:"20px"}},[s("el-steps",{attrs:{direction:"vertical",active:t.comp_active}},t._l(t.computer,(function(t,e){return s("el-step",{key:e,attrs:{title:t.title,icon:t.icon,status:t.status,description:t.description}})})),1)],1)])],2):t._e(),t.shard_show?s("el-step",{attrs:{title:t.shard_title,status:t.storage_state,icon:t.shard_icon,description:t.shard_description}},[s("template",{slot:"description"},[s("span",[t._v(t._s(t.shard_description))]),s("div",{staticStyle:{padding:"20px"}},[s("el-steps",{attrs:{direction:"vertical",active:t.shard_active}},t._l(t.shard,(function(e,i){return s("el-step",{key:i,attrs:{title:e.title,icon:e.icon,status:e.status,description:e.description},nativeOn:{click:function(s){return t.thisDetail(e.shard_id)}}})})),1)],1)])],2):t._e()],1)],1)]),s("el-dialog",{attrs:{title:t.dialogStatus,visible:t.dialogShardInfo,"custom-class":"single_dal_view","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogShardInfo=e}}},[s("json-viewer",{attrs:{value:t.shardInfo}})],1),s("el-dialog",{attrs:{title:"主备切换",visible:t.dialogSwitchOVisible,"custom-class":"single_dal_view"},on:{"update:visible":function(e){t.dialogSwitchOVisible=e}}},[s("el-form",{ref:"switchForm",attrs:{model:t.switchtemp,rules:t.rules,"label-position":"left","label-width":"100px"}},[s("el-form-item",{attrs:{label:"主节点:",prop:"primary_node"}},[s("span",[t._v(t._s(t.switchtemp.primary_node))])]),s("el-form-item",{attrs:{label:"备机节点:",prop:"replica"}},[s("el-select",{attrs:{clearable:"",placeholder:"请选择备机节点"},model:{value:t.switchtemp.replica,callback:function(e){t.$set(t.switchtemp,"replica",e)},expression:"switchtemp.replica"}},t._l(t.options,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.label}})})),1)],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dialogSwitchOVisible=!1}}},[t._v("关闭")]),s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.switchData(t.switchtemp)}}},[t._v("确认")])],1)],1),s("el-dialog",{attrs:{title:"重做备机节点",visible:t.dialogRedoVisible,"custom-class":"single_dal_view"},on:{"update:visible":function(e){t.dialogRedoVisible=e}}},[s("el-form",{ref:"redoForm",attrs:{model:t.redotemp,rules:t.rules,"label-position":"left","label-width":"180px"}},[s("el-form-item",{attrs:{label:"需重做的备机节点:",prop:"redolist"}},[s("el-select",{attrs:{multiple:"",placeholder:"请选择"},on:{change:t.change},model:{value:t.redotemp.redolist,callback:function(e){t.$set(t.redotemp,"redolist",e)},expression:"redotemp.redolist"}},t._l(t.options,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.label}})})),1)],1),s("el-form-item",{attrs:{label:"是否从主节点上拉取数据:",prop:"allow_pull_from_master"}},[s("el-radio",{attrs:{label:"1"},model:{value:t.redotemp.allow_pull_from_master,callback:function(e){t.$set(t.redotemp,"allow_pull_from_master",e)},expression:"redotemp.allow_pull_from_master"}},[t._v("是")]),s("el-radio",{attrs:{label:"0"},model:{value:t.redotemp.allow_pull_from_master,callback:function(e){t.$set(t.redotemp,"allow_pull_from_master",e)},expression:"redotemp.allow_pull_from_master"}},[t._v("否")])],1),"0"==t.redotemp.allow_pull_from_master?s("el-form-item",{attrs:{label:"主备延迟:",prop:"allow_replica_delay"}},[s("el-input",{staticClass:"right_input",attrs:{placeholder:"主备延迟"},model:{value:t.redotemp.allow_replica_delay,callback:function(e){t.$set(t.redotemp,"allow_replica_delay",e)},expression:"redotemp.allow_replica_delay"}},[s("i",{staticStyle:{"font-style":"normal","margin-right":"10px","line-height":"30px"},attrs:{slot:"suffix"},slot:"suffix"},[t._v("s")])])],1):t._e(),s("el-form-item",{attrs:{label:"是否备份:",prop:"need_backup"}},[s("el-radio",{attrs:{label:"1"},model:{value:t.redotemp.need_backup,callback:function(e){t.$set(t.redotemp,"need_backup",e)},expression:"redotemp.need_backup"}},[t._v("是")]),s("el-radio",{attrs:{label:"0"},model:{value:t.redotemp.need_backup,callback:function(e){t.$set(t.redotemp,"need_backup",e)},expression:"redotemp.need_backup"}},[t._v("否")])],1),"1"==t.redotemp.need_backup?s("el-form-item",{attrs:{label:"备份存储目标:",prop:"hdfs_host"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.redotemp.hdfs_host,callback:function(e){t.$set(t.redotemp,"hdfs_host",e)},expression:"redotemp.hdfs_host"}},t._l(t.hdfs_options,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.label}})})),1)],1):t._e(),s("el-form-item",{attrs:{label:"限速:",prop:"pv_limit"}},[s("el-input",{staticClass:"right_input",attrs:{placeholder:"限速"},model:{value:t.redotemp.pv_limit,callback:function(e){t.$set(t.redotemp,"pv_limit",e)},expression:"redotemp.pv_limit"}},[s("i",{staticStyle:{"font-style":"normal","margin-right":"10px","line-height":"30px"},attrs:{slot:"suffix"},slot:"suffix"},[t._v("KB/s")])])],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dialogRedoVisible=!1}}},[t._v("关闭")]),s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.redoData(t.redotemp)}}},[t._v("确认")])],1)],1),s("el-dialog",{attrs:{title:t.job_id,visible:t.dialogStatusRedoVisible,"custom-class":"single_dal_view","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogStatusRedoVisible=e}}},[s("div",{staticClass:"block",staticStyle:{width:"100%",background:"#fff",padding:"0 20px"}},[s("el-steps",{attrs:{direction:"vertical",active:t.init_active}},t._l(t.statusList,(function(e,i){return s("el-step",{key:i,attrs:{title:e.title,icon:e.icon,status:e.status,description:e.description}},[s("template",{slot:"description"},[s("span",[t._v(t._s(e.description))]),s("div",{staticStyle:{padding:"20px"}},[s("el-steps",{attrs:{direction:"vertical",active:t.second_active}},t._l(t.statusList[i].second,(function(t,e){return s("el-step",{key:e,attrs:{title:t.title,icon:t.icon,status:t.status,description:t.description}})})),1)],1)])],2)})),1)],1)])],1)},a=[],r=s("ade3"),o=(s("ac1f"),s("00b4"),s("b0c0"),s("5319"),s("d3b7"),s("159b"),s("a4d3"),s("e01a"),s("ed08")),n=s("333d"),c=s("578a"),l=s("82b0"),u=s("b775");function d(t){return Object(u["a"])({url:"/user/MetaCluster/getMetaClusterList",method:"get",params:t})}function p(){return Object(u["a"])({url:"/user/MetaCluster/getMetaPrimary",method:"get",param:""})}function h(){return Object(u["a"])({url:"/user/MetaCluster/getMetaStandbyNode",method:"get",param:""})}var m=s("349e"),_=s.n(m),f={name:"list",components:{Pagination:n["a"],JsonViewer:_.a},props:["data","defaultActive"],data:function(){var t,e=function(t,e,s){e?/^[0-9]+$/.test(e)?e>256?s(new Error("节点个数不能大于256")):s():s(new Error("节点个数只能输入数字")):s(new Error("请输入节点个数"))};return t={tableKey:0,list:null,listLoading:!0,searchLoading:!1,total:0,listQuery:{pageNo:1,pageSize:10,hostaddr:""},nodetemp:{machinelist:[],nodes:"1"},switchtemp:{replica:"",primary_node:"",shard_id:"-1",cluster_id:"-1"},redotemp:{redolist:[],allow_pull_from_master:"0",allow_replica_delay:"30",need_backup:"0",pv_limit:"10",hdfs_host:""},dialogFormVisible:!1,dialogRetreatedVisible:!1,dialogNodeVisible:!1,dialogStatusVisible:!1,dialogExpandVisible:!1,dialogExpandInfoVisible:!1,dialogExpondInfo:!1,expondSatus:!0,expondResult:!1,dialogStatus:"",textMap:{update:"添加节点"},dialogDetail:!1,message_tips:"",message_type:"",user_add_priv:"",user_drop_priv:"",user_edit_priv:"",row:{},hamodeData:c["g"],shardsDate:c["q"],norepshardsDate:c["l"],pershardDate:c["m"],isShow:!1,machinelist:[],machines:[],minMachine:0,machineTotal:0,comp_machines:[],comp_minMachine:0,comp_machineTotal:0,node_types:c["k"],shardList:[],work_mode:sessionStorage.getItem("work_mode"),meta_ha_mode:sessionStorage.getItem("meta_ha_mode"),cluster_drop_priv:JSON.parse(sessionStorage.getItem("priv")).cluster_drop_priv,storage_node_create_priv:JSON.parse(sessionStorage.getItem("priv")).storage_node_create_priv,timer:null,installStatus:!1,info:"",activities:[],dialogStatusShowVisible:!1,active:0,stepSuc:[0],stepParams:[],computer:[],shard:[],init_active:0,second_active:0,statusList:[],ipList:[],computer_state:"",storage_state:"",computer_title:"",computer_icon:"",shard_icon:"",shard_title:"",comp_active:0,shard_active:0,strogemachines:[],init_title:"",init_show:!0,computer_show:!0,shard_show:!0},Object(r["a"])(t,"init_active",0),Object(r["a"])(t,"finish_title",""),Object(r["a"])(t,"finish_icon",""),Object(r["a"])(t,"finish_description",""),Object(r["a"])(t,"computer_description",""),Object(r["a"])(t,"shard_description",""),Object(r["a"])(t,"shardInfo",""),Object(r["a"])(t,"dialogShardInfo",!1),Object(r["a"])(t,"job_id",""),Object(r["a"])(t,"oldClusterList",[]),Object(r["a"])(t,"shardNameList",[]),Object(r["a"])(t,"activeName",""),Object(r["a"])(t,"shardTable",[]),Object(r["a"])(t,"shardsList",[]),Object(r["a"])(t,"srcShardsList",[]),Object(r["a"])(t,"expondInfo",""),Object(r["a"])(t,"expondSatus",!0),Object(r["a"])(t,"expand_init",""),Object(r["a"])(t,"expand_end",""),Object(r["a"])(t,"expondInit",!0),Object(r["a"])(t,"expondResult",!1),Object(r["a"])(t,"outoExpandInfoVisible",!1),Object(r["a"])(t,"policys",c["n"]),Object(r["a"])(t,"dialogSwitchOVisible",!1),Object(r["a"])(t,"dialogStatusRedoVisible",!1),Object(r["a"])(t,"dialogRedoVisible",!1),Object(r["a"])(t,"hdfs_options",[]),Object(r["a"])(t,"options",[]),Object(r["a"])(t,"rules",{nodes:[{required:!0,trigger:"blur",validator:e}]}),t},created:function(){this.getList()},watch:{"temp.machinelist":{handler:function(t,e){}},"expandtemp.table_list":{handler:function(t,e){t.length>0?(this.expandtemp.dsc_flag=!0,this.expandtemp.title="提交"):(this.expandtemp.dsc_flag=!1,this.expandtemp.title="自动扩容",this.expandtemp.shard_name="")}},"autoexpandtemp.table_list":{handler:function(t,e){t.length>0?this.autoexpandtemp.dsc_flag=!0:this.autoexpandtemp.dsc_flag=!1}}},methods:{autoChangeDscShardName:function(t){for(var e=0;e<this.shardsList.length;e++)this.shardsList[e].id==t&&(this.autoexpandtemp.dst_shard_name=this.shardsList[e].name)},selAutoChangeHandle:function(t){this.autoexpandtemp.table_list=t},ChangeShardName:function(t){for(var e=0;e<this.shardsList.length;e++)this.shardsList[e].id==t&&(this.expandtemp.dst_shard_name=this.shardsList[e].name)},selectionChangeHandle:function(t){var e=this;if(this.expandtemp.shard_name=this.expandtemp.list.shard_name,this.expandtemp.table_list=t,this.expandtemp.shard_name){var s={cluster_id:this.expandtemp.list.cluster_id,shard_id:this.expandtemp.list.shard_id};Object(l["W"])(s).then((function(t){e.shardsList=t.list})),this.$nextTick((function(){e.$refs["dataForm"]&&e.$refs["dataForm"].clearValidate()}))}},handleClick:function(t){var e=this;if(t.$attrs.value){var s=t.$attrs.value.split("_");this.expandtemp.list.cluster_id=s[1],this.expandtemp.list.shard_id=s[0],this.expandtemp.list.shard_name=t.name,this.expandtemp.dst_shard_id="",this.shardTable=[];var i={cluster_id:s[1],id:s[0]};if(Object(l["Z"])(i).then((function(t){200==t.code?e.shardTable=t.list:(e.message_tips=t.message,e.message_type="error",Object(o["g"])(e.message_tips,e.message_type))})),this.expandtemp.shard_name){this.shardsList=[];var a={cluster_id:this.expandtemp.list.cluster_id,shard_id:this.expandtemp.list.shard_id};Object(l["W"])(a).then((function(t){e.shardsList=t.list})),this.$nextTick((function(){e.$refs["dataForm"]&&e.$refs["dataForm"].clearValidate()}))}}},beforeDestory:function(){clearInterval(this.timer),this.dialogStatusShowVisible=!1},thisDetail:function(t){var e=this,s={id:t};Object(l["cb"])(s).then((function(s){e.dialogStatus="shard_"+t+"详细信息",e.dialogShardInfo=!0,e.shardInfo=s.shard_nodes}))},handleStatus:function(){this.dialogStatusShowVisible=!0},toggle:function(){this.isShow=!this.isShow},handleFilter:function(){this.listQuery.pageNo=1,this.getList()},handleClear:function(){this.listQuery.hostaddr="",this.listQuery.pageNo=1,this.getList()},getList:function(){var t=this;this.listLoading=!0;var e=Object.assign({},this.listQuery);d(e).then((function(e){t.list=e.list,t.total=e.total,setTimeout((function(){t.listLoading=!1}),500)}))},resetTemp:function(){this.temp={ha_mode:"",shards_count:"1",snode_count:"3",comp_count:"1",buffer_pool:"1024",max_connections:"6",per_computing_node_cpu_cores:"8",per_computing_node_max_mem_size:"",per_storage_node_cpu_cores:"8",per_storage_node_innodb_buffer_pool_size:"",per_storage_node_rocksdb_buffer_pool_size:"",per_storage_node_initial_storage_size:"20",per_storage_node_max_storage_size:"20",nick_name:"",machinelist:[],comp_machinelist:[],node_type:"",shard_name:"",shards:"",computer_user:"",computer_password:"",fullsync_level:"1"}},resetNodeTemp:function(){this.nodetemp={machinelist:[],nodes:"1"}},resetSwitchtemp:function(){this.switchtemp={replica:"",primary_node:"",shard_id:"-1",cluster_id:"-1"}},resetRedoTemp:function(){this.redotemp={redolist:[],allow_pull_from_master:"0",allow_replica_delay:"30",need_backup:"0",pv_limit:"10",hdfs_host:""}},handleSwitch:function(){var t=this;this.resetSwitchtemp(),this.dialogSwitchOVisible=!0,p().then((function(e){e.list.length>0&&(t.switchtemp.primary_node=e.list[0].ip+"("+e.list[0].port+")")})),h().then((function(e){if(200==e.code&&(t.options=[],e.list.length>0))for(var s=0;s<e.list.length;s++){var i={value:s,label:e.list[s].ip+"("+e.list[s].port+")"};t.options.push(i)}}))},switchData:function(t){var e=this;this.$refs["switchForm"].validate((function(t){if(t){var s={};s.user_name=sessionStorage.getItem("login_username"),s.job_id="",s.job_type="manual_switch",s.version=c["u"][0].ver,s.timestamp=c["s"][0].time+"";var i=e.switchtemp.primary_node.substring(0,e.switchtemp.primary_node.length-1).replace("(","_"),a={};if(e.switchtemp.replica.length){var r=e.switchtemp.replica.substring(0,e.switchtemp.replica.length-1).replace("(","_");a.shard_id=e.switchtemp.shard_id,a.cluster_id=e.switchtemp.cluster_id,a.master_hostaddr=i,a.assign_hostaddr=r}else a.shard_id=e.switchtemp.shard_id,a.cluster_id=e.switchtemp.cluster_id,a.master_hostaddr=i;s.paras=a,Object(l["yb"])(s).then((function(t){var s=t;if("accept"==s.status){e.dialogSwitchOVisible=!1,e.stepParams=[];var i=0,a="主备切换";e.computer=[],e.shard=[],e.computer_state="",e.storage_state="",e.computer_title="",e.computer_icon="",e.shard_icon="",e.shard_title="",e.comp_active=0,e.shard_active=0,e.strogemachines=[],e.init_title="",e.init_active=0,e.finish_title="",e.finish_icon="",e.finish_description="",e.computer_description="",e.shard_description="",e.job_id="",e.timer=null,e.timer=setInterval((function(){e.getFStatus(e.timer,s.job_id,i++,a,"")}),1e3)}else e.message_tips=s.error_info,e.message_type="error",Object(o["g"])(e.message_tips,e.message_type)}))}}))},change:function(){this.options.length==this.redotemp.redolist.length?this.redotemp.allow_pull_from_master="1":this.redotemp.allow_pull_from_master="0"},handleRedo:function(){var t=this;this.resetRedoTemp(),this.dialogRedoVisible=!0,Object(l["x"])().then((function(e){if(t.hdfs_options=[],null!==e.list)for(var s=0;s<e.list.length;s++){var i={value:s,label:e.list[s].hostaddr+"("+e.list[s].port+")"};t.hdfs_options.push(i)}})),h().then((function(e){if(200==e.code&&(t.options=[],e.list.length>0))for(var s=0;s<e.list.length;s++){var i={value:s,label:e.list[s].ip+"("+e.list[s].port+")"};t.options.push(i)}}))},redoData:function(t){var e=this;this.$refs["redoForm"].validate((function(t){if(t){var s={};s.user_name=sessionStorage.getItem("login_username"),s.job_id="",s.job_type="rebuild_node",s.version=c["u"][0].ver,s.timestamp=c["s"][0].time+"";for(var i=[],a=[],r=0;r<e.redotemp.redolist.length;r++){var n=e.redotemp.redolist[r].substring(0,e.redotemp.redolist[r].length-1).split("("),u="";u=e.redotemp.pv_limit?e.redotemp.pv_limit:"10";var d={};if("1"==e.redotemp.need_backup){var p=e.redotemp.hdfs_host.substring(0,e.redotemp.hdfs_host.length-1).replace("(",":");d.hostaddr=n[0],d.port=n[1],d.need_backup=e.redotemp.need_backup,d.hdfs_host=p,d.pv_limit=u}else d.hostaddr=n[0],d.port=n[1],d.need_backup=e.redotemp.need_backup,d.pv_limit=u;i.push(d),a.push({title:n[0]+"_"+n[1],error_code:"0",error_info:"",status:"no_start",step:""})}var h={};"1"==e.redotemp.allow_pull_from_master?(h.shard_id="-1",h.cluster_id="-1",h.allow_pull_from_master=e.redotemp.allow_pull_from_master,h.rb_nodes=i):(h.shard_id="-1",h.cluster_id="-1",h.allow_pull_from_master=e.redotemp.allow_pull_from_master,h.allow_replica_delay=e.redotemp.allow_replica_delay,h.rb_nodes=i),s.paras=h,e.dialogStatusRedoVisible=!0,e.dialogRedoVisible=!1,Object(l["mb"])(s).then((function(t){var s=t;if("accept"==s.status){e.dialogRedoVisible=!1,e.stepParams=[];var i=0,r="重做备机节点";e.statusList=[],e.timer=null,e.init_active=0,e.second_active=0,e.getFStatus(e.timer,s.job_id,i++,r,a),e.timer=setInterval((function(){e.getFStatus(e.timer,s.job_id,i++,r,a)}),5e3)}else e.message_tips=s.error_info,e.message_type="error",Object(o["g"])(e.message_tips,e.message_type)}))}}))},handleUpdate:function(t){var e=this;this.resetNodeTemp(),this.dialogStatus="update",this.dialogNodeVisible=!0,this.dialogDetail=!1,Object(l["fb"])().then((function(t){e.strogemachines=[],e.strogemachines=t.list})),this.$nextTick((function(){e.$refs["nodeForm"].clearValidate()}))},updateData:function(){var t=this;this.$refs["nodeForm"].validate((function(e){if(e){var s=Object.assign({},t.nodetemp),i=[];s.machinelist.forEach((function(t){i.push(t)})),s.job_id="",s.version=c["u"][0].ver,s.user_name=sessionStorage.getItem("login_username"),s.job_type="add_nodes",s.timestamp=c["s"][0].time+"";var a={cluster_id:"-1"};a.nodes=s.nodes,a.shard_id="-1",i.length>0&&(a.storage_iplists=i),s.paras=a,t.$delete(s,"machinelist"),t.$delete(s,"nodes"),Object(l["c"])(s).then((function(e){var s=e;if("accept"==s.status){t.dialogNodeVisible=!1,t.dialogStatusShowVisible=!0,t.computer=[],t.shard=[],t.computer_state="",t.storage_state="",t.computer_title="",t.computer_icon="",t.shard_icon="",t.shard_title="",t.comp_active=0,t.shard_active=0,t.strogemachines=[],t.init_title="",t.init_active=0,t.finish_title="",t.finish_icon="",t.finish_description="",t.computer_description="",t.shard_description="",t.job_id="",t.timer=null,t.init_show=!0;var i="添加存储节点",a=0;t.getFStatus(t.timer,s.job_id,a++,i,""),t.timer=setInterval((function(){t.getFStatus(t.timer,s.job_id,a++,i,"")}),5e3)}else"ongoing"==s.status?(t.message_tips="系统正在操作中，请等待一会！",t.message_type="error",Object(o["g"])(t.message_tips,t.message_type)):(t.message_tips=s.error_info,t.message_type="error",Object(o["g"])(t.message_tips,t.message_type))}))}}))},handleDelete:function(t){var e=this,s=Object(o["a"])(),i="此操作将永久删除该数据, 是否继续?code="+s;Object(o["e"])(i).then((function(i){if(i.value){if(i.value==s){var a={};a.user_name=sessionStorage.getItem("login_username"),a.job_id="",a.job_type="delete_node",a.version=c["u"][0].ver,a.timestamp=c["s"][0].time+"";var r={cluster_id:"-1",shard_id:"-1"};return r.hostaddr=t.hostaddr,r.port=t.port,a.paras=r,void console.log(a)}e.message_tips="code输入有误",e.message_type="error",Object(o["g"])(e.message_tips,e.message_type)}else e.message_tips="code不能为空！",e.message_type="error",Object(o["g"])(e.message_tips,e.message_type)})).catch((function(){console.log("quxiao"),Object(o["g"])("已取消删除","info")}))},getFStatus:function(t,e,s,i,a){var r=this;setTimeout((function(){var n={job_type:"get_status"};n.version=c["u"][0].ver,n.job_id=e,n.timestamp=c["s"][0].time+"",n.paras={},r.job_id="任务ID:"+e,Object(l["J"])(n).then((function(e){if("添加shard"==i||"添加计算节点"==i||"添加存储节点"==i)if(null!==e.attachment){if("添加shard"==i||"添加存储节点"==i?(r.shard_show=!0,r.init_show=!1,r.computer_show=!1):"添加计算节点"==i&&(r.shard_show=!1,r.init_show=!1,r.computer_show=!0),e.attachment.hasOwnProperty("computer_state"))if("ongoing"==e.attachment.computer_state)r.computer_state="process",r.computer_icon="el-icon-loading",r.computer_title="正在"+i;else if("done"==e.attachment.computer_state){if(r.computer_state="success",r.computer_icon="el-icon-circle-check",r.computer_title=i+"成功",r.computer.length>0)for(var n=0;n<r.computer.length;n++)for(var c=e.attachment.computer_hosts.substr(0,e.attachment.computer_hosts.length-1),l=c.split(";"),u=0;u<l.length;u++)r.computer[n].title==l[u]&&(r.computer[n].icon="el-icon-circle-check",r.computer[n].status="success")}else if("failed"==e.attachment.computer_state){if(r.computer_state="error",r.computer_icon="el-icon-circle-close",r.computer_title=i+"失败",r.computer.length>0){for(var d=0;d<r.computer.length;d++)for(var p=e.attachment.computer_hosts.substr(0,e.attachment.computer_hosts.length-1),h=p.split(";"),m=0;m<h.length;m++)r.computer[d].title==h[m]&&(r.computer[d].icon="el-icon-circle-close",r.computer[d].status="error");r.computer_description=e.error_info}}else r.computer_state="process",r.computer_icon="el-icon-loading",r.computer_title="正在"+i;if(e.attachment.hasOwnProperty("storage_state"))if("ongoing"==e.attachment.storage_state)r.storage_state="process",r.shard_icon="el-icon-loading",r.shard_title="正在"+i;else if("done"==e.attachment.storage_state){if(r.storage_state="success",r.shard_icon="el-icon-circle-check",r.shard_title=i+"成功",r.shard.length>0)for(var _=0;_<r.shard.length;_++){var f="";f="添加shard"==i?e.attachment.shard_ids:e.attachment.shard_hosts;for(var g=0;g<f.length;g++)for(var b in f[g]){var v=f[g][b];r.shard[_].shard_id==v&&(r.shard[_].icon="el-icon-circle-check",r.shard[_].status="success")}}}else if("failed"==e.attachment.storage_state){if(r.storage_state="error",r.shard_icon="el-icon-circle-close",r.shard_title=i+"失败",r.shard.length>0){for(var L=0;L<r.shard.length;L++){var w="";w="添加shard"==i?e.attachment.shard_ids:e.attachment.shard_hosts;for(var j=0;j<w.length;j++)for(var b in w[j]){v=w[j][b];r.shard[L].shard_id==v&&(r.shard[L].icon="el-icon-circle-close",r.shard[L].status="error")}}r.shard_description=e.error_info}}else r.storage_state="process",r.shard_icon="el-icon-loading",r.shard_title="正在"+i;if(r.init_title="正在"+i,r.init_active=1,0==r.computer.length||0==r.shard.length){if(0==r.computer.length&&e.attachment.hasOwnProperty("computer_hosts")){var O=e.attachment.computer_hosts.substr(0,e.attachment.computer_hosts.length-1),y=O.split(";");if("done"==e.attachment.computer_state)for(var k=0;k<y.length;k++){var C={};C.title=y[k],C.icon="el-icon-circle-check",C.status="success",C.description="",C.computer_id=e.attachment.computer_id,r.computer.push(C)}else for(var S=0;S<y.length;S++){var x={};x.title=y[S],x.icon="el-icon-loading",x.status="process",x.description="",x.computer_id=e.attachment.computer_id,r.computer.push(x)}}if(0==r.shard.length&&e.attachment.hasOwnProperty("shard_hosts")){var I="";I="添加shard"==i?e.attachment.shard_ids:e.attachment.shard_hosts;for(var P=0;P<I.length;P++)for(var b in I[P]){var V={};v=I[P][b];console.log(v);var $=b+":"+v;V.title=""!==v?$:"正在"+i,V.icon="el-icon-loading",V.status="process",V.description="",V.shard_id=v,r.shard.push(V)}}if("failed"==e.status){if(r.storage_state="error",r.shard_icon="el-icon-circle-close",r.shard_title=i+"失败",r.init_show=!1,r.computer_state="error",r.computer_icon="el-icon-circle-close",r.computer_title=i+"失败",r.finish_title=i+"失败",r.finish_icon="el-icon-circle-close",r.init_active=1,r.finish_description=e.error_info,r.computer.length>0){for(var N=0;N<r.computer.length;N++)if(e.attachment.hasOwnProperty("computer_hosts"))for(var T=e.attachment.computer_hosts.substr(0,e.attachment.computer_hosts.length-1),D=T.split(";"),M=0;M<D.length;M++)r.computer[N].title==D[M]&&(r.computer[N].icon="el-icon-circle-close",r.computer[N].status="error");r.computer_description=e.error_info}if(r.shard.length>0){for(var z=0;z<r.shard.length;z++){var F="";if(e.attachment.hasOwnProperty("shard_hosts")){F="添加shard"==i?e.attachment.shard_ids:e.attachment.shard_hosts;for(var R=0;R<F.length;R++)for(var b in F[R]){v=F[R][b];r.shard[z].shard_id==v&&(r.shard[z].icon="el-icon-circle-close",r.shard[z].status="error")}}}r.shard_description=e.error_info}clearInterval(t)}else if("done"==e.status){if(r.storage_state="success",r.shard_icon="el-icon-circle-check",r.shard_title=i+"成功",r.computer_state="success",r.computer_icon="el-icon-circle-check",r.computer_title=i+"成功",r.finish_title=i+"成功",r.finish_icon="el-icon-circle-check",r.init_active=1,r.finish_description=e.error_info,r.computer.length>0)for(var B=0;B<r.computer.length;B++)if(e.attachment.hasOwnProperty("computer_hosts"))for(var E=e.attachment.computer_hosts.substr(0,e.attachment.computer_hosts.length-1),Q=E.split(";"),A=0;A<Q.length;A++)r.computer[B].title==Q[A]&&(r.computer[B].icon="el-icon-circle-check",r.computer[B].status="success");if(r.shard.length>0)for(var q=0;q<r.shard.length;q++){var J="";if(e.attachment.hasOwnProperty("shard_hosts")){J="添加shard"==i?e.attachment.shard_ids:e.attachment.shard_hosts;for(var U=0;U<J.length;U++)for(var b in J[U]){v=J[U][b];r.shard[q].shard_id==v&&(r.shard[q].icon="el-icon-circle-check",r.shard[q].status="success")}}}clearInterval(t),r.getList()}}}else null==e.attachment&&"70001"==e.error_code&&"failed"==e.status?"添加shard"==i||"添加存储节点"==i?(r.shard_show=!0,r.init_show=!1,r.computer_show=!1,r.storage_state="process",r.shard_icon="el-icon-loading",r.shard_title="正在"+i,s>5&&(r.storage_state="error",r.shard_icon="el-icon-circle-close",r.shard_title=i+"失败",clearInterval(t))):"添加计算节点"==i&&(r.shard_show=!1,r.init_show=!1,r.computer_show=!0,r.computer_state="process",r.computer_icon="el-icon-loading",r.computer_title="正在"+i,s>5&&(r.computer_state="error",r.computer_icon="el-icon-circle-close",r.computer_title=i+"失败",clearInterval(t))):null==e.attachment&&"ongoing"==e.status?"添加shard"==i||"添加存储节点"==i?(r.shard_show=!0,r.init_show=!1,r.computer_show=!1,r.storage_state="process",r.shard_icon="el-icon-loading",r.shard_title="正在"+i):"添加计算节点"==i&&(r.shard_show=!1,r.init_show=!1,r.computer_show=!0,r.computer_state="process",r.computer_icon="el-icon-loading",r.computer_title="正在"+i):null==e.attachment&&"done"==e.status?("添加shard"==i||"添加存储节点"==i?(r.shard_show=!0,r.init_show=!1,r.computer_show=!1,r.storage_state="success",r.shard_icon="el-icon-circle-check",r.shard_title=i+"成功"):"添加计算节点"==i&&(r.shard_show=!1,r.init_show=!1,r.computer_show=!0,r.computer_state="success",r.computer_icon="el-icon-circle-check",r.computer_title=i+"成功"),clearInterval(t)):("添加shard"==i||"添加存储节点"==i?(r.shard_show=!0,r.init_show=!1,r.computer_show=!1,r.storage_state="error",r.shard_icon="el-icon-circle-close",r.shard_title=i+"失败"):"添加计算节点"==i&&(r.shard_show=!1,r.init_show=!1,r.computer_show=!0,r.computer_state="error",r.computer_icon="el-icon-circle-close",r.computer_title=i+"失败"),clearInterval(t));else if("扩容"==i)null!==e.attachment?"failed"==e.status?(r.expand_end="集群扩容失败",r.expondInit=!1,r.expondSatus=!0,r.expondResult=!0,r.expondInfo=e.attachment.memo_info,console.log(e.attachment.memo_info),clearInterval(t)):"done"==e.status?(r.expand_end="集群扩容成功",r.expondInit=!1,r.expondSatus=!0,r.expondResult=!0,r.expondInfo=e.attachment.memo_info,clearInterval(t)):(r.expand_init="正在进行集群扩容",r.expondInit=!0,r.expondSatus=!1,r.expondResult=!1,r.expondInfo=e.attachment.memo_info):null==e.attachment&&"failed"==e.status&&(r.expondInit=!1,r.expondSatus=!1,r.expondResult=!0,r.expand_end="集群扩容失败",clearInterval(t));else if("主备切换"==i)if(null!==e.attachment){r.dialogStatusFVisible=!0;var H=e.attachment.job_step.replace(/\s+/g,"").split(",");if(0==r.stepParams.length)for(var K=0;K<H.length;K++){var W={};if(0==K?(W.title=H[K],W.icon="el-icon-loading",W.status="process",W.description=""):(W.title=H[K],W.icon="",W.status="wait",W.description=""),e.attachment.step==H[K]){if(K>r.active)for(var G=0;G<r.stepParams.length;G++)if(G==K&&"wait"==r.stepParams[G].status&&(r.stepParams[G].icon="el-icon-loading",r.stepParams[G].status="process"),G>0&&G<K)for(var Y=0;Y<G;Y++)r.stepParams[Y].icon="el-icon-circle-check",r.stepParams[Y].status="success";r.active=K}r.stepParams.push(W)}else if("ongoing"==e.status){for(var Z=0;Z<r.stepParams.length;Z++)if(e.attachment.step==r.stepParams[Z].title&&(r.active=Z,r.stepParams[Z].icon="el-icon-loading",r.stepParams[Z].status="process",Z>0&&Z<r.active+1))for(var X=0;X<Z;X++)r.stepParams[X].icon="el-icon-circle-check",r.stepParams[X].status="success"}else if("done"==e.status){for(var tt=0;tt<r.stepParams.length;tt++)r.active=r.stepParams.length,r.stepParams[tt].icon="el-icon-circle-check",r.stepParams[tt].status="success";clearInterval(t)}else if("failed"==e.status){for(var et=0;et<r.stepParams.length;et++)"process"==r.stepParams[et].status&&(r.active=et,r.stepParams[et].icon="el-icon-circle-close",r.stepParams[et].status="error",r.stepParams[et].description=e.error_info);clearInterval(t)}}else null==e.attachment&&"70001"==e.error_code&&"failed"==e.status&&s>5&&clearInterval(t);else if("重做备机节点"==i)if(null!==e.attachment)if(0==r.statusList.length){var st={};if("failed"==e.status)st={title:i+"失败",icon:"el-icon-circle-close",status:"error",description:e.error_code,second:[]},r.statusList.push(st),clearInterval(t);else for(var it=0;it<a.length;it++){for(var at=e.attachment.job_step.replace(/\s+/g,"").split(","),rt={},ot=[],nt=0;nt<at.length;nt++)rt={title:at[nt],icon:"",status:"wait",description:""},ot.push(rt);if(0==it){if(st={title:a[it].title,icon:"el-icon-loading",status:"process",description:"",second:ot},r.statusList.push(st),"done"==a[it].status){r.init_active=it+1,r.statusList[it].icon="el-icon-circle-check",r.statusList[it].status="success";for(var ct=0;ct<r.statusList[it].second.length;ct++)r.statusList[it].second[ct].icon="el-icon-circle-check",r.statusList[it].second[ct].status="success"}else if("ongoing"==a[it].status){r.init_active=it,r.statusList[it].icon="el-icon-loading",r.statusList[it].status="process";for(var lt=0;lt<r.statusList[it].second.length;lt++)if(a[it].step==r.statusList[it].second[lt].title){r.statusList[it].second[lt].icon="el-icon-loading",r.statusList[it].second[lt].status="process";for(var ut=0;ut<lt;ut++)r.statusList[it].second[ut].icon="el-icon-circle-check",r.statusList[it].second[ut].status="success"}}else if("failed"==a[it].status){r.statusList[it].icon="el-icon-circle-close",r.statusList[it].status="error";for(var dt=0;dt<r.statusList[it].second.length;dt++)if(a[it].step==r.statusList[it].second[dt].title){r.statusList[it].second[dt].icon="el-icon-circle-close",r.statusList[it].second[dt].status="error";for(var pt=0;pt<dt;pt++)r.statusList[it].second[pt].icon="el-icon-circle-check",r.statusList[it].second[pt].status="success"}r.statusList[it].description=a[it].error_info}}else{for(var ht=e.attachment.job_step.replace(/\s+/g,"").split(","),mt={},_t=[],ft=0;ft<ht.length;ft++)mt={title:ht[ft],icon:"",status:"wait",description:""},_t.push(mt);if(0==r.init_active?(st={title:a[it].title,icon:"",status:"wait",description:"",second:_t},r.statusList.push(st)):(st={title:a[it].title,icon:"el-icon-loading",status:"process",description:"",second:_t},r.statusList.push(st)),"done"==a[it].status){r.init_active=it+1,r.statusList[it].icon="el-icon-circle-check",r.statusList[it].status="success";for(var gt=0;gt<r.statusList[it].second.length;gt++)r.statusList[it].second[gt].icon="el-icon-circle-check",r.statusList[it].second[gt].status="success"}else if("ongoing"==a[it].status){r.init_active=it,r.statusList[it].icon="el-icon-loading",r.statusList[it].status="process";for(var bt=0;bt<r.statusList[it].second.length;bt++)if(a[it].step==r.statusList[it].second[bt].title){r.statusList[it].second[bt].icon="el-icon-loading",r.statusList[it].second[bt].status="process";for(var vt=0;vt<bt;vt++)r.statusList[it].second[vt].icon="el-icon-circle-check",r.statusList[it].second[vt].status="success"}}else if("failed"==a[it].status){r.statusList[it].icon="el-icon-circle-close",r.statusList[it].status="error";for(var Lt=0;Lt<r.statusList[it].second.length;Lt++)if(a[it].step==r.statusList[it].second[Lt].title){r.statusList[it].second[Lt].icon="el-icon-circle-close",r.statusList[it].second[Lt].status="error";for(var wt=0;wt<Lt;wt++)r.statusList[it].second[wt].icon="el-icon-circle-check",r.statusList[it].second[wt].status="success"}r.statusList[it].description=a[it].error_info}}}}else if("ongoing"==e.status){var jt=[];for(var Ot in e.attachment)if("job_step"!==Ot){var yt=e.attachment[Ot];r.$set(yt,"title",Ot),jt.push(yt)}for(var kt=0;kt<jt.length;kt++)if(0==kt){if("done"==jt[kt].status){r.init_active=kt+1,r.statusList[kt].icon="el-icon-circle-check",r.statusList[kt].status="success";for(var Ct=0;Ct<r.statusList[kt].second.length;Ct++)r.statusList[kt].second[Ct].icon="el-icon-circle-check",r.statusList[kt].second[Ct].status="success"}else if("ongoing"==jt[kt].status){r.init_active=kt,r.statusList[kt].icon="el-icon-loading",r.statusList[kt].status="process";for(var St=0;St<r.statusList[kt].second.length;St++)if(jt[kt].step==r.statusList[kt].second[St].title){r.statusList[kt].second[St].icon="el-icon-loading",r.statusList[kt].second[St].status="process";for(var xt=0;xt<St;xt++)r.statusList[kt].second[xt].icon="el-icon-circle-check",r.statusList[kt].second[xt].status="success"}}else if("failed"==jt[kt].status){r.statusList[kt].icon="el-icon-circle-close",r.statusList[kt].status="error";for(var It=0;It<r.statusList[kt].second.length;It++)if(jt[kt].step==r.statusList[kt].second[It].title){r.statusList[kt].second[It].icon="el-icon-circle-close",r.statusList[kt].second[It].status="error";for(var Pt=0;Pt<It;Pt++)r.statusList[kt].second[Pt].icon="el-icon-circle-check",r.statusList[kt].second[Pt].status="success"}r.statusList[kt].description=jt[kt].error_info}}else if("done"==jt[kt].status){r.init_active=kt+1,r.statusList[kt].icon="el-icon-circle-check",r.statusList[kt].status="success";for(var Vt=0;Vt<r.statusList[kt].second.length;Vt++)r.statusList[kt].second[Vt].icon="el-icon-circle-check",r.statusList[kt].second[Vt].status="success"}else if("ongoing"==jt[kt].status){r.init_active=kt,r.statusList[kt].icon="el-icon-loading",r.statusList[kt].status="process";for(var $t=0;$t<r.statusList[kt].second.length;$t++)if(jt[kt].step==r.statusList[kt].second[$t].title){r.statusList[kt].second[$t].icon="el-icon-loading",r.statusList[kt].second[$t].status="process";for(var Nt=0;Nt<$t;Nt++)r.statusList[kt].second[Nt].icon="el-icon-circle-check",r.statusList[kt].second[Nt].status="success"}}else if("failed"==jt[kt].status){r.statusList[kt].icon="el-icon-circle-close",r.statusList[kt].status="error";for(var Tt=0;Tt<r.statusList[kt].second.length;Tt++)if(jt[kt].step==r.statusList[kt].second[Tt].title){r.statusList[kt].second[Tt].icon="el-icon-circle-close",r.statusList[kt].second[Tt].status="error";for(var Dt=0;Dt<Tt;Dt++)r.statusList[kt].second[Dt].icon="el-icon-circle-check",r.statusList[kt].second[Dt].status="success"}r.statusList[kt].description=jt[kt].error_info}}else if("failed"==e.status){var Mt=[];for(var zt in e.attachment)if("job_step"!==zt){var Ft=e.attachment[zt];r.$set(Ft,"title",zt),Mt.push(Ft)}for(var Rt=0;Rt<Mt.length;Rt++)if(0==Rt){if("done"==Mt[Rt].status){r.init_active=Rt+1,r.statusList[Rt].icon="el-icon-circle-check",r.statusList[Rt].status="success";for(var Bt=0;Bt<r.statusList[Rt].second.length;Bt++)r.statusList[Rt].second[Bt].icon="el-icon-circle-check",r.statusList[Rt].second[Bt].status="success"}else if("ongoing"==Mt[Rt].status){r.init_active=Rt,r.statusList[Rt].icon="el-icon-loading",r.statusList[Rt].status="process";for(var Et=0;Et<r.statusList[Rt].second.length;Et++)if(Mt[Rt].step==r.statusList[Rt].second[Et].title){r.statusList[Rt].second[Et].icon="el-icon-loading",r.statusList[Rt].second[Et].status="process";for(var Qt=0;Qt<Et;Qt++)r.statusList[Rt].second[Qt].icon="el-icon-circle-check",r.statusList[Rt].second[Qt].status="success"}}else if("failed"==Mt[Rt].status){r.statusList[Rt].icon="el-icon-circle-close",r.statusList[Rt].status="error";for(var At=0;At<r.statusList[Rt].second.length;At++)if(Mt[Rt].step==r.statusList[Rt].second[At].title){r.statusList[Rt].second[At].icon="el-icon-circle-close",r.statusList[Rt].second[At].status="error";for(var qt=0;qt<At;qt++)r.statusList[Rt].second[qt].icon="el-icon-circle-check",r.statusList[Rt].second[qt].status="success"}r.statusList[Rt].description=Mt[Rt].error_info}}else if("done"==Mt[Rt].status){r.init_active=Rt+1,r.statusList[Rt].icon="el-icon-circle-check",r.statusList[Rt].status="success";for(var Jt=0;Jt<r.statusList[Rt].second.length;Jt++)r.statusList[Rt].second[Jt].icon="el-icon-circle-check",r.statusList[Rt].second[Jt].status="success"}else if("ongoing"==Mt[Rt].status){r.init_active=Rt,r.statusList[Rt].icon="el-icon-loading",r.statusList[Rt].status="process";for(var Ut=0;Ut<r.statusList[Rt].second.length;Ut++)if(Mt[Rt].step==r.statusList[Rt].second[Ut].title){r.statusList[Rt].second[Ut].icon="el-icon-loading",r.statusList[Rt].second[Ut].status="process";for(var Ht=0;Ht<Ut;Ht++)r.statusList[Rt].second[Ht].icon="el-icon-circle-check",r.statusList[Rt].second[Ht].status="success"}}else if("failed"==Mt[Rt].status){r.statusList[Rt].icon="el-icon-circle-close",r.statusList[Rt].status="error";for(var Kt=0;Kt<r.statusList[Rt].second.length;Kt++)if(Mt[Rt].step==r.statusList[Rt].second[Kt].title){r.statusList[Rt].second[Kt].icon="el-icon-circle-close",r.statusList[Rt].second[Kt].status="error";for(var Wt=0;Wt<Kt;Wt++)r.statusList[Rt].second[Wt].icon="el-icon-circle-check",r.statusList[Rt].second[Wt].status="success"}r.statusList[Rt].description=Mt[Rt].error_info}var Gt={title:i+"失败",icon:"el-icon-circle-close",status:"error",description:e.error_info,second:""};r.statusList.push(Gt),clearInterval(t)}else if("done"==e.status){var Yt=[];for(var Zt in e.attachment)if("job_step"!==Zt){var Xt=e.attachment[Zt];r.$set(Xt,"title",Zt),Yt.push(Xt)}for(var te=0;te<Yt.length;te++)if(0==te){if("done"==Yt[te].status){r.init_active=te+1,r.statusList[te].icon="el-icon-circle-check",r.statusList[te].status="success";for(var ee=0;ee<r.statusList[te].second.length;ee++)r.statusList[te].second[ee].icon="el-icon-circle-check",r.statusList[te].second[ee].status="success"}else if("ongoing"==Yt[te].status){r.init_active=te,r.statusList[te].icon="el-icon-loading",r.statusList[te].status="process";for(var se=0;se<r.statusList[te].second.length;se++)if(Yt[te].step==r.statusList[te].second[se].title){r.statusList[te].second[se].icon="el-icon-loading",r.statusList[te].second[se].status="process";for(var ie=0;ie<se;ie++)r.statusList[te].second[ie].icon="el-icon-circle-check",r.statusList[te].second[ie].status="success"}}else if("failed"==Yt[te].status){r.statusList[te].icon="el-icon-circle-close",r.statusList[te].status="error";for(var ae=0;ae<r.statusList[te].second.length;ae++)if(Yt[te].step==r.statusList[te].second[ae].title){r.statusList[te].second[ae].icon="el-icon-circle-close",r.statusList[te].second[ae].status="error";for(var re=0;re<ae;re++)r.statusList[te].second[re].icon="el-icon-circle-check",r.statusList[te].second[re].status="success"}r.statusList[te].description=Yt[te].error_info}}else if("done"==Yt[te].status){r.init_active=te+1,r.statusList[te].icon="el-icon-circle-check",r.statusList[te].status="success";for(var oe=0;oe<r.statusList[te].second.length;oe++)r.statusList[te].second[oe].icon="el-icon-circle-check",r.statusList[te].second[oe].status="success"}else if("ongoing"==Yt[te].status){r.init_active=te,r.statusList[te].icon="el-icon-loading",r.statusList[te].status="process";for(var ne=0;ne<r.statusList[te].second.length;ne++)if(Yt[te].step==r.statusList[te].second[ne].title){r.statusList[te].second[ne].icon="el-icon-loading",r.statusList[te].second[ne].status="process";for(var ce=0;ce<ne;ce++)r.statusList[te].second[ce].icon="el-icon-circle-check",r.statusList[te].second[ce].status="success"}}else if("failed"==Yt[te].status){r.statusList[te].icon="el-icon-circle-close",r.statusList[te].status="error";for(var le=0;le<r.statusList[te].second.length;le++)if(Yt[te].step==r.statusList[te].second[le].title){r.statusList[te].second[le].icon="el-icon-circle-close",r.statusList[te].second[le].status="error";for(var ue=0;ue<le;ue++)r.statusList[te].second[ue].icon="el-icon-circle-check",r.statusList[te].second[ue].status="success"}r.statusList[te].description=Yt[te].error_info}var de={title:i+"成功",icon:"el-icon-circle-check",status:"success",description:"",second:""};r.statusList.push(de),clearInterval(t)}else r.message_tips=e.error_info,r.message_type="error",Object(o["g"])(r.message_tips,r.message_type);else if(null==e.attachment&&"70001"==e.error_code&&"failed"==e.status){if(s>5){var pe={title:i+"失败",icon:"el-icon-circle-close",status:"error",description:e.error_code,second:[]};r.statusList.push(pe),clearInterval(t)}}else if(null==e.attachment&&"ongoing"==e.status){r.statusList=[];var he={};he={title:"正在"+i,icon:"el-icon-loading",status:"process",description:"",second:[]},r.statusList.push(he)}else if(null==e.attachment&&"done"==e.status){r.statusList=[];var me={};me={title:i+"成功",icon:"el-icon-circle-check",status:"success",description:"",second:[]},r.statusList.push(me),clearInterval(t)}else{r.statusList=[];var _e={};_e={title:i+"失败",icon:"el-icon-circle-close",status:"error",description:e.error_code,second:[]},r.statusList.push(_e),clearInterval(t)}else if("删除存储节点"==i)if(null!==e.attachment){if("删除存储节点"==i&&(r.shard_show=!0,r.init_show=!1,r.computer_show=!1,console.log(10)),"ongoing"==e.attachment.storage_state?(r.storage_state="process",r.shard_icon="el-icon-loading",r.shard_title="正在"+i):"done"==e.attachment.storage_state?(console.log(4),r.storage_state="success",r.shard_icon="el-icon-circle-check",r.shard_title=i+"成功"):"failed"==e.attachment.storage_state?(console.log(5),r.storage_state="error",r.shard_icon="el-icon-circle-close",r.shard_title=i+"失败"):(console.log(6),r.storage_state="process",r.shard_icon="el-icon-loading",r.shard_title="正在"+i),r.init_title="正在"+i,r.init_active=1,0==r.computer.length||0==r.shard.length){if(1==r.computer_show&&0==r.computer.length){console.log(1);var fe={};if(e.attachment.hasOwnProperty("computer_hosts"))for(var ge=e.attachment.computer_hosts.substr(0,e.attachment.computer_hosts.length-1),be=ge.split(";"),ve=0;ve<be.length;ve++)"done"==e.attachment.computer_state?(fe.title=!0===e.attachment.hasOwnProperty("computer_hosts")?be[ve]:"正在"+i,fe.icon="el-icon-circle-check",fe.status="success",fe.description="",fe.computer_id=e.attachment.computer_id,r.computer.push(fe)):"failed"==e.attachment.computer_state?(fe.title=!0===e.attachment.hasOwnProperty("computer_hosts")?be[ve]:"正在"+i,fe.icon="el-icon-circle-close",fe.status="error",fe.description=e.error_info,fe.computer_id=e.attachment.computer_id,r.computer.push(fe)):(fe.title=!0===e.attachment.hasOwnProperty("computer_hosts")?be[ve]:"正在"+i,fe.icon="el-icon-loading",fe.status="process",fe.description="",fe.computer_id=e.attachment.computer_id,r.computer.push(fe))}if(1==r.shard_show&&0==r.shard.length&&(console.log(2),e.attachment.hasOwnProperty("storage_state")))if("done"==e.attachment.storage_state){var Le="";console.log(3),Le=e.attachment.shard_id;var we={};we.title=""!==Le?Le:"正在"+i,we.icon="el-icon-circle-check",we.status="success",we.description="",we.shard_id=v,r.shard.push(we)}else if("failed"==e.attachment.storage_state){var je="";je=e.attachment.shard_id;var Oe={};Oe.title=""!==je?je:"正在"+i,Oe.icon="el-icon-circle-close",Oe.status="error",Oe.description=e.error_info,Oe.shard_id=v,r.shard.push(Oe)}else{var ye="";ye=e.attachment.shard_id;var ke={};ke.title=""!==ye?ye:"正在"+i,ke.icon="el-icon-loading",ke.status="process",ke.description="",ke.shard_id=ye,r.shard.push(ke)}if("failed"==e.status){if(console.log(7),r.storage_state="error",r.shard_icon="el-icon-circle-close",r.shard_title=i+"失败",r.init_show=!1,r.finish_title=i+"失败",r.finish_icon="el-icon-circle-close",r.init_active=1,r.finish_description=e.error_info,r.shard.length>0){for(var Ce=0;Ce<r.shard.length;Ce++){var Se="";Se=e.attachment.shard_id,r.shard[Ce].shard_id==Se&&(r.shard[Ce].icon="el-icon-circle-close",r.shard[Ce].status="error")}r.shard_description=e.error_info}clearInterval(t)}else if("done"==e.status){if(console.log(8),r.storage_state="success",r.shard_icon="el-icon-circle-check",r.shard_title=i+"成功",r.finish_title=i+"成功",r.finish_icon="el-icon-circle-check",r.init_active=1,r.finish_description=e.error_info,r.shard.length>0){console.log(9);for(var xe=0;xe<r.shard.length;xe++){var Ie="";Ie=e.attachment.shard_id,r.shard[xe].shard_id==Ie&&(r.shard[xe].icon="el-icon-circle-check",r.shard[xe].status="success")}}clearInterval(t),r.getCluster()}}}else null==e.attachment&&"70001"==e.error_code&&"failed"==e.status?"删除存储节点"==i&&(r.shard_show=!0,r.init_show=!1,r.computer_show=!1,r.storage_state="process",r.shard_icon="el-icon-loading",r.shard_title="正在"+i,s>5&&(r.storage_state="error",r.shard_icon="el-icon-circle-close",r.shard_title=i+"失败",clearInterval(t))):null==e.attachment&&"ongoing"==e.status?"删除存储节点"==i&&(r.shard_show=!0,r.init_show=!1,r.computer_show=!1,r.storage_state="process",r.shard_icon="el-icon-loading",r.shard_title="正在"+i):null==e.attachment&&"done"==e.status?("删除存储节点"==i&&(r.shard_show=!0,r.init_show=!1,r.computer_show=!1,r.storage_state="success",r.shard_icon="el-icon-circle-check",r.shard_title=i+"成功"),clearInterval(t)):("删除存储节点"==i&&(r.shard_show=!0,r.init_show=!1,r.computer_show=!1,r.storage_state="error",r.shard_icon="el-icon-circle-close",r.shard_title=i+"失败"),clearInterval(t))})),s>=86400&&clearInterval(t)}),0)},getStatus:function(t,e,s){var i=this;setTimeout((function(){var a={job_type:"get_status"};a.version=c["u"][0].ver,a.job_id=e,a.timestamp=c["s"][0].time+"",a.paras={},Object(l["J"])(a).then((function(e){var s="";if(null!==e.attachment&&(s=""!==e.attachment.memo_info.error_info?e.attachment.memo_info.error_info:e.error_info),"done"==e.status||"failed"==e.status)if(clearInterval(t),"done"==e.status){var a={content:"集群回档成功",timestamp:Object(o["d"])(),color:"#0bbd87",icon:"el-icon-circle-check"};i.activities.push(a),i.getList()}else{var r={content:s,timestamp:Object(o["d"])(),color:"red",icon:"el-icon-circle-close"};i.activities.push(r)}else if(s){var n={content:s,timestamp:Object(o["d"])(),color:"#0bbd87"};i.activities.push(n)}})),s>=86400&&clearInterval(t)}),0)}}},g=f,b=(s("0ac5"),s("ddd0"),s("2877")),v=Object(b["a"])(g,i,a,!1,null,"412dca4d",null);e["default"]=v.exports},ed08:function(t,e,s){"use strict";s.d(e,"g",(function(){return a})),s.d(e,"f",(function(){return r})),s.d(e,"b",(function(){return o})),s.d(e,"d",(function(){return n})),s.d(e,"c",(function(){return c})),s.d(e,"a",(function(){return l})),s.d(e,"e",(function(){return u}));s("53ca"),s("ac1f"),s("00b4"),s("5319"),s("4d63"),s("2c3e"),s("25f0"),s("d3b7"),s("4d90"),s("159b");var i=s("5c96");function a(t,e){return Object(i["Message"])({message:t,type:e,duration:2e3})}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"确定执行此操作吗？",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"warning";return i["MessageBox"].confirm(t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:e,center:!0})}function o(t){var e=t.split("T");return e[0]+" "+e[1]}function n(){var t=new Date,e="-",s=":",i=t.getFullYear(),a=t.getMonth()+1,r=t.getDate(),o=t.getHours(),n=t.getMinutes(),c=t.getSeconds(),l=["星期一","星期二","星期三","星期四","星期五","星期六","星期天"];l[t.getDay()];a>=1&&a<=9&&(a="0"+a),r>=0&&r<=9&&(r="0"+r),o>=0&&o<=9&&(o="0"+o),n>=0&&n<=9&&(n="0"+n),c>=0&&c<=9&&(c="0"+c);var u=i+e+a+e+r+" "+o+s+n+s+c;return u}function c(t){var e=t.split("-"),s=e[0],i=e[1],a=e[2],r=new Date(s,i,0);r=r.getDate();var o=s,n=parseInt(i)+1;13==n&&(o=parseInt(o)+1,n=1);var c=a,l=new Date(o,n,0);l=l.getDate(),c>l&&(c=l),n<10&&(n="0"+n);var u=o+"-"+n+"-"+c;return u}function l(){for(var t="",e=4,s=new Array(0,1,2,3,4,5,6,7,8,9),i=0;i<e;i++){var a=Math.floor(9*Math.random());t+=s[a]}return t}function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"确定执行此操作吗？",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"warning";return i["MessageBox"].prompt(t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"请输入code",inputPattern:/^[0-9]\d*$/,inputErrorMessage:"code格式不正确",type:e})}}}]);