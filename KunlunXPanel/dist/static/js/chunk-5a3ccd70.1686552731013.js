(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a3ccd70"],{"0ac5":function(t,e,s){"use strict";s("ea1d")},"333d":function(t,e,s){"use strict";var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pagination-container",class:{hidden:t.hidden}},[s("el-pagination",t._b({attrs:{background:t.background,"current-page":t.currentPage,"page-size":t.pageSize,layout:t.layout,"page-sizes":t.pageSizes,total:t.total},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},"el-pagination",t.$attrs,!1))],1)},i=[];s("a9e3");Math.easeInOutQuad=function(t,e,s,r){return t/=r/2,t<1?s/2*t*t+e:(t--,-s/2*(t*(t-2)-1)+e)};var a=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function o(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function n(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function c(t,e,s){var r=n(),i=t-r,c=20,l=0;e="undefined"===typeof e?500:e;var u=function t(){l+=c;var n=Math.easeInOutQuad(l,r,i,e);o(n),l<e?a(t):s&&"function"===typeof s&&s()};u()}var l={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit("update:page",t)}},pageSize:{get:function(){return this.limit},set:function(t){this.$emit("update:limit",t)}}},methods:{handleSizeChange:function(t){this.$emit("pagination",{page:this.currentPage,limit:t}),this.autoScroll&&c(0,800)},handleCurrentChange:function(t){this.$emit("pagination",{page:t,limit:this.pageSize}),this.autoScroll&&c(0,800)}}},u=l,d=(s("d059"),s("2877")),p=Object(d["a"])(u,r,i,!1,null,"65877abe",null);e["a"]=p.exports},"82b0":function(t,e,s){"use strict";s.d(e,"F",(function(){return i})),s.d(e,"P",(function(){return a})),s.d(e,"S",(function(){return o})),s.d(e,"o",(function(){return n})),s.d(e,"p",(function(){return c})),s.d(e,"j",(function(){return l})),s.d(e,"B",(function(){return u})),s.d(e,"sb",(function(){return d})),s.d(e,"wb",(function(){return p})),s.d(e,"z",(function(){return h})),s.d(e,"hb",(function(){return m})),s.d(e,"h",(function(){return _})),s.d(e,"e",(function(){return f})),s.d(e,"g",(function(){return g})),s.d(e,"Q",(function(){return b})),s.d(e,"H",(function(){return v})),s.d(e,"s",(function(){return L})),s.d(e,"q",(function(){return w})),s.d(e,"t",(function(){return j})),s.d(e,"Bb",(function(){return O})),s.d(e,"Cb",(function(){return k})),s.d(e,"Db",(function(){return C})),s.d(e,"Eb",(function(){return y})),s.d(e,"ub",(function(){return S})),s.d(e,"vb",(function(){return x})),s.d(e,"O",(function(){return I})),s.d(e,"Hb",(function(){return P})),s.d(e,"Z",(function(){return V})),s.d(e,"lb",(function(){return $})),s.d(e,"nb",(function(){return N})),s.d(e,"ob",(function(){return D})),s.d(e,"fb",(function(){return T})),s.d(e,"mb",(function(){return M})),s.d(e,"K",(function(){return F})),s.d(e,"C",(function(){return z})),s.d(e,"Fb",(function(){return R})),s.d(e,"d",(function(){return E})),s.d(e,"i",(function(){return B})),s.d(e,"Jb",(function(){return Q})),s.d(e,"u",(function(){return A})),s.d(e,"tb",(function(){return q})),s.d(e,"jb",(function(){return J})),s.d(e,"ib",(function(){return U})),s.d(e,"L",(function(){return H})),s.d(e,"ab",(function(){return W})),s.d(e,"bb",(function(){return K})),s.d(e,"D",(function(){return G})),s.d(e,"k",(function(){return Y})),s.d(e,"kb",(function(){return X})),s.d(e,"I",(function(){return Z})),s.d(e,"J",(function(){return tt})),s.d(e,"gb",(function(){return et})),s.d(e,"db",(function(){return st})),s.d(e,"y",(function(){return rt})),s.d(e,"R",(function(){return it})),s.d(e,"xb",(function(){return at})),s.d(e,"V",(function(){return ot})),s.d(e,"W",(function(){return nt})),s.d(e,"A",(function(){return ct})),s.d(e,"zb",(function(){return lt})),s.d(e,"qb",(function(){return ut})),s.d(e,"rb",(function(){return dt})),s.d(e,"cb",(function(){return pt})),s.d(e,"m",(function(){return ht})),s.d(e,"Ab",(function(){return mt})),s.d(e,"Y",(function(){return _t})),s.d(e,"yb",(function(){return ft})),s.d(e,"v",(function(){return gt})),s.d(e,"n",(function(){return bt})),s.d(e,"pb",(function(){return vt})),s.d(e,"G",(function(){return Lt})),s.d(e,"Gb",(function(){return wt})),s.d(e,"eb",(function(){return jt})),s.d(e,"l",(function(){return Ot})),s.d(e,"M",(function(){return kt})),s.d(e,"T",(function(){return Ct})),s.d(e,"U",(function(){return yt})),s.d(e,"Ib",(function(){return St})),s.d(e,"w",(function(){return xt})),s.d(e,"x",(function(){return It})),s.d(e,"b",(function(){return Pt})),s.d(e,"E",(function(){return Vt})),s.d(e,"a",(function(){return $t})),s.d(e,"c",(function(){return Nt})),s.d(e,"X",(function(){return Dt})),s.d(e,"f",(function(){return Tt})),s.d(e,"N",(function(){return Mt})),s.d(e,"r",(function(){return Ft}));var r=s("b775");function i(t){return Object(r["a"])({url:"/user/Cluster/clusterList",method:"get",params:t})}function a(t){return Object(r["a"])({url:"/user/Cluster/getEffectComp",method:"post",data:t})}function o(t){return Object(r["a"])({url:"/user/Cluster/getExperience",method:"post",data:t})}function n(t){return Object(r["a"])({url:"/user/Cluster/createCluster",method:"post",data:t})}function c(t){return Object(r["a"])({url:"/user/Cluster/delCluster",method:"post",data:t})}function l(t){return Object(r["a"])({url:"/user/Cluster/backUpCluster",method:"post",data:t})}function u(t){return Object(r["a"])({url:"/user/Cluster/getBackUpList",method:"get",params:t})}function d(t){return Object(r["a"])({url:"/user/Cluster/ifBackUp",method:"post",data:{id:t}})}function p(t){return Object(r["a"])({url:"/user/Cluster/restoreCluster",method:"post",data:t})}function h(){return Object(r["a"])({url:"/user/Cluster/getAllMachine",method:"get",params:""})}function m(t){return Object(r["a"])({url:"/user/Cluster/getShards",method:"post",data:{id:t}})}function _(t){return Object(r["a"])({url:"/user/Cluster/addShards",method:"post",data:t})}function f(t){return Object(r["a"])({url:"/user/Cluster/addComps",method:"post",data:t})}function g(t){return Object(r["a"])({url:"/user/Cluster/addNodes",method:"post",data:t})}function b(t){return Object(r["a"])({url:"/user/Cluster/getStatus",method:"post",data:t})}function v(t){return Object(r["a"])({url:"/user/Cluster/getClusterNodesList",method:"post",data:t})}function L(t){return Object(r["a"])({url:"/user/Cluster/delShard",method:"post",data:t})}function w(t){return Object(r["a"])({url:"/user/Cluster/delComp",method:"post",data:t})}function j(t){return Object(r["a"])({url:"/user/Cluster/delSnode",method:"post",data:t})}function O(t){return Object(r["a"])({url:"/user/Cluster/controlInstance",method:"post",data:t})}function k(t){return Object(r["a"])({url:"/user/Cluster/controlInstance",method:"post",data:t})}function C(t){return Object(r["a"])({url:"/user/Cluster/controlInstance",method:"post",data:t})}function y(t){return Object(r["a"])({url:"/user/Cluster/controlInstance",method:"post",data:t})}function S(t){return Object(r["a"])({url:"/user/Cluster/controlInstance",method:"post",data:t})}function x(t){return Object(r["a"])({url:"/user/Cluster/controlInstance",method:"post",data:t})}function I(t){return Object(r["a"])({url:"/user/Cluster/getEffectCluster",method:"post",data:t})}function P(t){return Object(r["a"])({url:"/user/Cluster/updateAssign",method:"post",data:t})}function V(t){return Object(r["a"])({url:"/user/Cluster/getNode",method:"post",data:t})}function $(t){return Object(r["a"])({url:"/user/Cluster/getStandbyNode",method:"post",data:t})}function N(t){return Object(r["a"])({url:"/user/Cluster/getSwitcheOverList",method:"get",params:t})}function D(t){return Object(r["a"])({url:"/user/Cluster/getTaskList",method:"get",params:t})}function T(t){return Object(r["a"])({url:"/user/Cluster/getShardPrimary",method:"post",data:t})}function M(){return Object(r["a"])({url:"/user/Cluster/getStroMachine",method:"get",params:""})}function F(){return Object(r["a"])({url:"/user/Cluster/getCompMachine",method:"get",params:""})}function z(t){return Object(r["a"])({url:"/user/Cluster/getBackUpStorage",method:"post",data:t})}function R(t){return Object(r["a"])({url:"/user/Cluster/switchShard",method:"post",data:t})}function E(t){return Object(r["a"])({url:"/user/Cluster/SetCpuCgroup",method:"post",data:t})}function B(t){return Object(r["a"])({url:"/user/Cluster/addStorage",method:"post",data:t})}function Q(t){return Object(r["a"])({url:"/user/Cluster/updateStorage",method:"post",data:t})}function A(t){return Object(r["a"])({url:"/user/Cluster/delStorage",method:"post",data:t})}function q(t){return Object(r["a"])({url:"/user/Cluster/rebuildNode",method:"post",data:t})}function J(t){return Object(r["a"])({url:"/user/Cluster/getShardsJobLog",method:"post",data:t})}function U(t){return Object(r["a"])({url:"/user/Cluster/getShardsCount",method:"get",params:t})}function H(t){return Object(r["a"])({url:"/user/Cluster/getCompsCount",method:"get",params:t})}function W(t){return Object(r["a"])({url:"/user/Cluster/getNodesCount",method:"get",params:t})}function K(t){return Object(r["a"])({url:"/user/Cluster/getOldCluster",method:"get",params:t})}function G(){return Object(r["a"])({url:"/user/Cluster/getBackupStorageList",method:"get",params:""})}function Y(t){return Object(r["a"])({url:"/user/Cluster/clusterListError",method:"get",params:t})}function X(t){return Object(r["a"])({url:"/user/Cluster/getShardsName",method:"get",params:t})}function Z(t){return Object(r["a"])({url:"/user/Cluster/getCompDBName",method:"get",params:t})}function tt(t){return Object(r["a"])({url:"/user/Cluster/getCompDBTable",method:"get",params:t})}function et(t){return Object(r["a"])({url:"/user/Cluster/getShardTable",method:"get",params:t})}function st(t){return Object(r["a"])({url:"/user/Cluster/getOtherShards",method:"get",params:t})}function rt(t){return Object(r["a"])({url:"/user/Cluster/expandCluster",method:"post",data:t})}function it(t){return Object(r["a"])({url:"/user/Cluster/getExpandTableList",method:"post",data:t})}function at(t){return Object(r["a"])({url:"/user/Cluster/setMaxDalay",method:"post",data:t})}function ot(t){return Object(r["a"])({url:"/user/Cluster/getMaxDalay",method:"post",data:t})}function nt(t){return Object(r["a"])({url:"/user/Cluster/getMetaCluster",method:"get",params:t})}function ct(t){return Object(r["a"])({url:"/user/Cluster/getBackStorageList",method:"get",params:t})}function lt(t){return Object(r["a"])({url:"/user/Cluster/setVariable",method:"post",data:t})}function ut(t){return Object(r["a"])({url:"/user/Cluster/getVariable",method:"post",data:t})}function dt(t){return Object(r["a"])({url:"/user/Cluster/getWorkMode",method:"post",data:t})}function pt(t){return Object(r["a"])({url:"/user/Cluster/getOneBackUpList",method:"get",params:t})}function ht(t){return Object(r["a"])({url:"/user/Cluster/computeList",method:"get",params:t})}function mt(t){return Object(r["a"])({url:"/user/Cluster/shardList",method:"get",params:t})}function _t(t){return Object(r["a"])({url:"/user/Cluster/getNoSwitchList",method:"post",data:t})}function ft(t){return Object(r["a"])({url:"/user/Cluster/setNoSwitch",method:"post",data:t})}function gt(t){return Object(r["a"])({url:"/user/Cluster/delSwitch",method:"post",data:t})}function bt(t){return Object(r["a"])({url:"/user/Cluster/controlInstance",method:"post",data:t})}function vt(t){return Object(r["a"])({url:"/user/Cluster/getThisShardNodes",method:"post",data:t})}function Lt(t){return Object(r["a"])({url:"/user/Cluster/getClusterMonitor",method:"get",params:t})}function wt(t){return Object(r["a"])({url:"/user/ClusterSetting/tableRepartition",method:"post",data:t})}function jt(t){return Object(r["a"])({url:"/user/ClusterSetting/getPGTableList",method:"get",params:t})}function Ot(t){return Object(r["a"])({url:"/user/ClusterSetting/clusterOptions",method:"get",params:t})}function kt(t){return Object(r["a"])({url:"/user/ClusterSetting/getDataCenters",method:"get",params:t})}function Ct(t){return Object(r["a"])({url:"/user/Cluster/getLogicalBackUpList",method:"get",params:t})}function yt(t){return Object(r["a"])({url:"/user/ClusterSetting/getRecordLogicalBackup",method:"get",params:t})}function St(t){return Object(r["a"])({url:"/user/Cluster/updateShard",method:"post",data:t})}function xt(t){return Object(r["a"])({url:"/user/Cluster/cdcEdit",method:"post",data:t})}function It(t){return Object(r["a"])({url:"/user/Cluster/cdcEditWork",method:"post",data:t})}function Pt(t){return Object(r["a"])({url:"/user/Cluster/CdcDelete",method:"post",data:t})}function Vt(t){return Object(r["a"])({url:"/user/Cluster/getCdcList",method:"post",data:t})}function $t(t){return Object(r["a"])({url:"/user/Cluster/getCdcWorkerList",method:"post",data:t})}function Nt(t){return Object(r["a"])({url:"/user/Cluster/DeleteCdcWorker",method:"post",data:t})}function Dt(t){return Object(r["a"])({url:"/user/MetaCluster/getMetaClusterList",method:"get",params:t})}function Tt(t){return Object(r["a"])({url:"/user/Cluster/addESList",method:"post",data:t})}function Mt(t){return Object(r["a"])({url:"/user/Cluster/getESList",method:"get",params:t})}function Ft(t){return Object(r["a"])({url:"/user/Cluster/delESList",method:"post",data:t})}},bbec:function(t,e,s){},cd35:function(t,e,s){},d059:function(t,e,s){"use strict";s("bbec")},ddd0:function(t,e,s){"use strict";s("cd35")},ea1d:function(t,e,s){},eb5a:function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-container"},[s("div",{staticClass:"filter-container"},[s("div",{staticClass:"table-list-search-wrap"},[s("el-input",{staticClass:"list_search_keyword",attrs:{placeholder:"可输入IP搜索"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleFilter(e)}},model:{value:t.listQuery.hostaddr,callback:function(e){t.$set(t.listQuery,"hostaddr",e)},expression:"listQuery.hostaddr"}}),s("el-button",{attrs:{icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v(" 查询 ")]),s("el-button",{attrs:{icon:"el-icon-refresh-right"},on:{click:t.handleClear}},[t._v(" 重置 ")]),"rbr"===t.meta_ha_mode?s("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:t.handleSwitch}},[s("i",{staticClass:"el-icon-sort",staticStyle:{transform:"rotate(90deg)"}}),t._v("主备切换")]):t._e(),"rbr"===t.meta_ha_mode?s("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-copy-document"},on:{click:t.handleRedo}},[t._v("重做备机")]):t._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:!0===t.installStatus,expression:"installStatus === true"}],staticClass:"info",domProps:{textContent:t._s(t.info)}})],1)]),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],key:t.tableKey,staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:t.list,border:"","highlight-current-row":""}},[s("el-table-column",{attrs:{type:"index",align:"center",label:"序号",width:"50"}}),s("el-table-column",{attrs:{label:"IP",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[s("span",{staticClass:"link-type",on:{click:function(e){return t.handleDetail(r)}}},[t._v(t._s(r.hostaddr))])]}}])}),s("el-table-column",{attrs:{prop:"port",label:"端口",align:"center"}}),s("el-table-column",{attrs:{align:"center",label:"高可用模式"}},[[s("span",[t._v(t._s(t.meta_ha_mode))])]],2),s("el-table-column",{attrs:{align:"center",label:"节点状态"},scopedSlots:t._u([{key:"default",fn:function(e){return["source"===e.row.member_state?s("span",[t._v("主节点")]):"replica"==e.row.member_state?s("span",[t._v("备机节点")]):s("span")]}}])}),s("el-table-column",{attrs:{align:"center",label:"同步状态"},scopedSlots:t._u([{key:"default",fn:function(e){return["fsync"===e.row.sync_state?s("span",[t._v("同步")]):"async"==e.row.sync_state?s("span",[t._v("异步")]):s("span")]}}])}),s("el-table-column",{attrs:{prop:"replica_delay",align:"center",label:"主备延迟时间(s)"}})],1),s("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total > 0"}],attrs:{total:t.total,page:t.listQuery.pageNo,limit:t.listQuery.pageSize},on:{"update:page":function(e){return t.$set(t.listQuery,"pageNo",e)},"update:limit":function(e){return t.$set(t.listQuery,"pageSize",e)},pagination:t.getList}}),s("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogNodeVisible,"custom-class":"single_dal_view","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogNodeVisible=e}}},[s("el-form",{ref:"nodeForm",attrs:{model:t.nodetemp,rules:t.rules,"label-position":"left","label-width":"110px"}},["update"===t.dialogStatus?s("el-form-item",{attrs:{label:"选择计算机:",prop:"machinelist"}},[s("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:t.nodetemp.machinelist,callback:function(e){t.$set(t.nodetemp,"machinelist",e)},expression:"nodetemp.machinelist"}},t._l(t.strogemachines,(function(t){return s("el-option",{key:t.id,attrs:{label:t.hostaddr,value:t.hostaddr}})})),1)],1):t._e(),s("el-form-item",{attrs:{label:"节点个数:",prop:"nodes"}},[s("el-input",{staticClass:"right_input",attrs:{placeholder:"请输入节点个数",disabled:"detail"===t.dialogStatus},model:{value:t.nodetemp.nodes,callback:function(e){t.$set(t.nodetemp,"nodes",e)},expression:"nodetemp.nodes"}},[s("i",{staticStyle:{"font-style":"normal","margin-right":"10px","line-height":"30px"},attrs:{slot:"suffix"},slot:"suffix"},[t._v("个")])])],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dialogNodeVisible=!1}}},[t._v("关闭")]),s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.updateData(t.row)}}},[t._v("确认")])],1)],1),s("el-dialog",{attrs:{visible:t.dialogStatusVisible,"custom-class":"single_dal_view",width:"400px","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogStatusVisible=e}}},[s("div",{staticClass:"block"},[s("el-timeline",t._l(t.activities,(function(e,r){return s("el-timeline-item",{key:r,attrs:{icon:e.icon,type:e.type,color:e.color,size:e.size,timestamp:e.timestamp}},[t._v(" "+t._s(e.content)+" ")])})),1)],1)]),s("el-dialog",{attrs:{title:t.job_id,visible:t.dialogStatusShowVisible,"custom-class":"single_dal_view","close-on-click-modal":!1,"before-close":t.beforeDestory},on:{"update:visible":function(e){t.dialogStatusShowVisible=e}}},[s("div",{staticStyle:{width:"100%",background:"#fff",padding:"0 20px"}},[s("el-steps",{attrs:{direction:"vertical",active:t.init_active}},[t.init_show?s("el-step",{attrs:{title:t.init_title,icon:"el-icon-more"}}):t._e(),t.computer_show?s("el-step",{attrs:{title:t.computer_title,status:t.computer_state,icon:t.computer_icon,description:t.computer_description}},[s("template",{slot:"description"},[s("span",[t._v(t._s(t.computer_description))]),s("div",{staticStyle:{padding:"20px"}},[s("el-steps",{attrs:{direction:"vertical",active:t.comp_active}},t._l(t.computer,(function(t,e){return s("el-step",{key:e,attrs:{title:t.title,icon:t.icon,status:t.status,description:t.description}})})),1)],1)])],2):t._e(),t.shard_show?s("el-step",{attrs:{title:t.shard_title,status:t.storage_state,icon:t.shard_icon,description:t.shard_description}},[s("template",{slot:"description"},[s("span",[t._v(t._s(t.shard_description))]),s("div",{staticStyle:{padding:"20px"}},[s("el-steps",{attrs:{direction:"vertical",active:t.shard_active}},t._l(t.shard,(function(e,r){return s("el-step",{key:r,attrs:{title:e.title,icon:e.icon,status:e.status,description:e.description},nativeOn:{click:function(s){return t.thisDetail(e.shard_id)}}})})),1)],1)])],2):t._e()],1)],1)]),s("el-dialog",{attrs:{title:t.dialogStatus,visible:t.dialogShardInfo,"custom-class":"single_dal_view","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogShardInfo=e}}},[s("json-viewer",{attrs:{value:t.shardInfo}})],1),s("el-dialog",{attrs:{title:"主备切换",visible:t.dialogSwitchOVisible,"custom-class":"single_dal_view"},on:{"update:visible":function(e){t.dialogSwitchOVisible=e}}},[s("el-form",{ref:"switchForm",attrs:{model:t.switchtemp,rules:t.rules,"label-position":"left","label-width":"100px"}},[s("el-form-item",{attrs:{label:"主节点:",prop:"primary_node"}},[s("span",[t._v(t._s(t.switchtemp.primary_node))])]),s("el-form-item",{attrs:{label:"备机节点:",prop:"replica"}},[s("el-select",{attrs:{clearable:"",placeholder:"请选择备机节点"},model:{value:t.switchtemp.replica,callback:function(e){t.$set(t.switchtemp,"replica",e)},expression:"switchtemp.replica"}},t._l(t.options,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.label}})})),1)],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dialogSwitchOVisible=!1}}},[t._v("关闭")]),s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.switchData(t.switchtemp)}}},[t._v("确认")])],1)],1),s("el-dialog",{attrs:{title:"重做备机节点",visible:t.dialogRedoVisible,"custom-class":"single_dal_view"},on:{"update:visible":function(e){t.dialogRedoVisible=e}}},[s("el-form",{ref:"redoForm",attrs:{model:t.redotemp,rules:t.rules,"label-position":"left","label-width":"180px"}},[s("el-form-item",{attrs:{label:"需重做的备机节点:",prop:"redolist"}},[s("el-select",{attrs:{multiple:"",placeholder:"请选择"},on:{change:t.change},model:{value:t.redotemp.redolist,callback:function(e){t.$set(t.redotemp,"redolist",e)},expression:"redotemp.redolist"}},t._l(t.options,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.label}})})),1)],1),s("el-form-item",{attrs:{label:"是否从主节点上拉取数据:",prop:"allow_pull_from_master"}},[s("el-radio",{attrs:{label:"1"},model:{value:t.redotemp.allow_pull_from_master,callback:function(e){t.$set(t.redotemp,"allow_pull_from_master",e)},expression:"redotemp.allow_pull_from_master"}},[t._v("是")]),s("el-radio",{attrs:{label:"0"},model:{value:t.redotemp.allow_pull_from_master,callback:function(e){t.$set(t.redotemp,"allow_pull_from_master",e)},expression:"redotemp.allow_pull_from_master"}},[t._v("否")])],1),"0"==t.redotemp.allow_pull_from_master?s("el-form-item",{attrs:{label:"主备延迟:",prop:"allow_replica_delay"}},[s("el-input",{staticClass:"right_input",attrs:{placeholder:"主备延迟"},model:{value:t.redotemp.allow_replica_delay,callback:function(e){t.$set(t.redotemp,"allow_replica_delay",e)},expression:"redotemp.allow_replica_delay"}},[s("i",{staticStyle:{"font-style":"normal","margin-right":"10px","line-height":"30px"},attrs:{slot:"suffix"},slot:"suffix"},[t._v("s")])])],1):t._e(),s("el-form-item",{attrs:{label:"是否备份:",prop:"need_backup"}},[s("el-radio",{attrs:{label:"1"},model:{value:t.redotemp.need_backup,callback:function(e){t.$set(t.redotemp,"need_backup",e)},expression:"redotemp.need_backup"}},[t._v("是")]),s("el-radio",{attrs:{label:"0"},model:{value:t.redotemp.need_backup,callback:function(e){t.$set(t.redotemp,"need_backup",e)},expression:"redotemp.need_backup"}},[t._v("否")])],1),"1"==t.redotemp.need_backup?s("el-form-item",{attrs:{label:"备份存储目标:",prop:"hdfs_host"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.redotemp.hdfs_host,callback:function(e){t.$set(t.redotemp,"hdfs_host",e)},expression:"redotemp.hdfs_host"}},t._l(t.hdfs_options,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.label}})})),1)],1):t._e(),s("el-form-item",{attrs:{label:"限速:",prop:"pv_limit"}},[s("el-input",{staticClass:"right_input",attrs:{placeholder:"限速"},model:{value:t.redotemp.pv_limit,callback:function(e){t.$set(t.redotemp,"pv_limit",e)},expression:"redotemp.pv_limit"}},[s("i",{staticStyle:{"font-style":"normal","margin-right":"10px","line-height":"30px"},attrs:{slot:"suffix"},slot:"suffix"},[t._v("KB/s")])])],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dialogRedoVisible=!1}}},[t._v("关闭")]),s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.redoData(t.redotemp)}}},[t._v("确认")])],1)],1),s("el-dialog",{attrs:{title:t.job_id,visible:t.dialogStatusRedoVisible,"custom-class":"single_dal_view","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogStatusRedoVisible=e}}},[s("div",{staticClass:"block",staticStyle:{width:"100%",background:"#fff",padding:"0 20px"}},[s("el-steps",{attrs:{direction:"vertical",active:t.init_active}},t._l(t.statusList,(function(e,r){return s("el-step",{key:r,attrs:{title:e.title,icon:e.icon,status:e.status,description:e.description}},[s("template",{slot:"description"},[s("span",[t._v(t._s(e.description))]),s("div",{staticStyle:{padding:"20px"}},[s("el-steps",{attrs:{direction:"vertical",active:t.second_active}},t._l(t.statusList[r].second,(function(t,e){return s("el-step",{key:e,attrs:{title:t.title,icon:t.icon,status:t.status,description:t.description}})})),1)],1)])],2)})),1)],1)])],1)},i=[],a=s("ade3"),o=(s("ac1f"),s("00b4"),s("b64b"),s("b0c0"),s("5319"),s("d3b7"),s("159b"),s("a4d3"),s("e01a"),s("ed08")),n=s("333d"),c=s("578a"),l=s("82b0"),u=s("b775");function d(t){return Object(u["a"])({url:"/user/MetaCluster/getMetaClusterList",method:"get",params:t})}function p(){return Object(u["a"])({url:"/user/MetaCluster/getMetaPrimary",method:"get",param:""})}function h(){return Object(u["a"])({url:"/user/MetaCluster/getMetaStandbyNode",method:"get",param:""})}var m=s("349e"),_=s.n(m),f={name:"list",components:{Pagination:n["a"],JsonViewer:_.a},props:["data","defaultActive"],data:function(){var t,e=function(t,e,s){e?/^[0-9]+$/.test(e)?e>256?s(new Error("节点个数不能大于256")):s():s(new Error("节点个数只能输入数字")):s(new Error("请输入节点个数"))};return t={tableKey:0,list:null,listLoading:!0,searchLoading:!1,total:0,listQuery:{pageNo:1,pageSize:10,hostaddr:""},nodetemp:{machinelist:[],nodes:"1"},switchtemp:{replica:"",primary_node:"",shard_id:"-1",cluster_id:"-1"},redotemp:{redolist:[],allow_pull_from_master:"0",allow_replica_delay:"30",need_backup:"0",pv_limit:"10",hdfs_host:""},dialogFormVisible:!1,dialogRetreatedVisible:!1,dialogNodeVisible:!1,dialogStatusVisible:!1,dialogExpandVisible:!1,dialogExpandInfoVisible:!1,dialogExpondInfo:!1,expondSatus:!0,expondResult:!1,dialogStatus:"",textMap:{update:"添加节点"},dialogDetail:!1,message_tips:"",message_type:"",user_add_priv:"",user_drop_priv:"",user_edit_priv:"",row:{},hamodeData:c["g"],shardsDate:c["q"],norepshardsDate:c["l"],pershardDate:c["m"],isShow:!1,machinelist:[],machines:[],minMachine:0,machineTotal:0,comp_machines:[],comp_minMachine:0,comp_machineTotal:0,node_types:c["k"],shardList:[],work_mode:sessionStorage.getItem("work_mode"),meta_ha_mode:sessionStorage.getItem("meta_ha_mode"),cluster_drop_priv:JSON.parse(sessionStorage.getItem("priv")).cluster_drop_priv,storage_node_create_priv:JSON.parse(sessionStorage.getItem("priv")).storage_node_create_priv,timer:null,installStatus:!1,info:"",activities:[],dialogStatusShowVisible:!1,active:0,stepSuc:[0],stepParams:[],computer:[],shard:[],init_active:0,second_active:0,statusList:[],ipList:[],computer_state:"",storage_state:"",computer_title:"",computer_icon:"",shard_icon:"",shard_title:"",comp_active:0,shard_active:0,strogemachines:[],init_title:"",init_show:!0,computer_show:!0,shard_show:!0},Object(a["a"])(t,"init_active",0),Object(a["a"])(t,"finish_title",""),Object(a["a"])(t,"finish_icon",""),Object(a["a"])(t,"finish_description",""),Object(a["a"])(t,"computer_description",""),Object(a["a"])(t,"shard_description",""),Object(a["a"])(t,"shardInfo",""),Object(a["a"])(t,"dialogShardInfo",!1),Object(a["a"])(t,"job_id",""),Object(a["a"])(t,"oldClusterList",[]),Object(a["a"])(t,"shardNameList",[]),Object(a["a"])(t,"activeName",""),Object(a["a"])(t,"shardTable",[]),Object(a["a"])(t,"shardsList",[]),Object(a["a"])(t,"srcShardsList",[]),Object(a["a"])(t,"expondInfo",""),Object(a["a"])(t,"expondSatus",!0),Object(a["a"])(t,"expand_init",""),Object(a["a"])(t,"expand_end",""),Object(a["a"])(t,"expondInit",!0),Object(a["a"])(t,"expondResult",!1),Object(a["a"])(t,"outoExpandInfoVisible",!1),Object(a["a"])(t,"policys",c["n"]),Object(a["a"])(t,"dialogSwitchOVisible",!1),Object(a["a"])(t,"dialogStatusRedoVisible",!1),Object(a["a"])(t,"dialogRedoVisible",!1),Object(a["a"])(t,"hdfs_options",[]),Object(a["a"])(t,"options",[]),Object(a["a"])(t,"rules",{nodes:[{required:!0,trigger:"blur",validator:e}]}),t},created:function(){this.getList()},watch:{"temp.machinelist":{handler:function(t,e){}},"expandtemp.table_list":{handler:function(t,e){t.length>0?(this.expandtemp.dsc_flag=!0,this.expandtemp.title="提交"):(this.expandtemp.dsc_flag=!1,this.expandtemp.title="自动扩容",this.expandtemp.shard_name="")}},"autoexpandtemp.table_list":{handler:function(t,e){t.length>0?this.autoexpandtemp.dsc_flag=!0:this.autoexpandtemp.dsc_flag=!1}}},methods:{autoChangeDscShardName:function(t){for(var e=0;e<this.shardsList.length;e++)this.shardsList[e].id==t&&(this.autoexpandtemp.dst_shard_name=this.shardsList[e].name)},selAutoChangeHandle:function(t){this.autoexpandtemp.table_list=t},ChangeShardName:function(t){for(var e=0;e<this.shardsList.length;e++)this.shardsList[e].id==t&&(this.expandtemp.dst_shard_name=this.shardsList[e].name)},selectionChangeHandle:function(t){var e=this;if(this.expandtemp.shard_name=this.expandtemp.list.shard_name,this.expandtemp.table_list=t,this.expandtemp.shard_name){var s={cluster_id:this.expandtemp.list.cluster_id,shard_id:this.expandtemp.list.shard_id};Object(l["db"])(s).then((function(t){e.shardsList=t.list})),this.$nextTick((function(){e.$refs["dataForm"]&&e.$refs["dataForm"].clearValidate()}))}},handleClick:function(t){var e=this;if(t.$attrs.value){var s=t.$attrs.value.split("_");this.expandtemp.list.cluster_id=s[1],this.expandtemp.list.shard_id=s[0],this.expandtemp.list.shard_name=t.name,this.expandtemp.dst_shard_id="",this.shardTable=[];var r={cluster_id:s[1],id:s[0]};if(Object(l["gb"])(r).then((function(t){200==t.code?e.shardTable=t.list:(e.message_tips=t.message,e.message_type="error",Object(o["g"])(e.message_tips,e.message_type))})),this.expandtemp.shard_name){this.shardsList=[];var i={cluster_id:this.expandtemp.list.cluster_id,shard_id:this.expandtemp.list.shard_id};Object(l["db"])(i).then((function(t){e.shardsList=t.list})),this.$nextTick((function(){e.$refs["dataForm"]&&e.$refs["dataForm"].clearValidate()}))}}},beforeDestory:function(){clearInterval(this.timer),this.dialogStatusShowVisible=!1},thisDetail:function(t){var e=this,s={id:t};Object(l["jb"])(s).then((function(s){e.dialogStatus="shard_"+t+"详细信息",e.dialogShardInfo=!0,e.shardInfo=s.shard_nodes}))},handleStatus:function(){this.dialogStatusShowVisible=!0},toggle:function(){this.isShow=!this.isShow},handleFilter:function(){this.listQuery.pageNo=1,this.getList()},handleClear:function(){this.listQuery.hostaddr="",this.listQuery.pageNo=1,this.getList()},getList:function(){var t=this;this.listLoading=!0;var e=Object.assign({},this.listQuery);d(e).then((function(e){t.list=e.list,t.total=e.total,setTimeout((function(){t.listLoading=!1}),500)}))},resetTemp:function(){this.temp={ha_mode:"",shards_count:"1",snode_count:"3",comp_count:"1",buffer_pool:"1024",max_connections:"6",per_computing_node_cpu_cores:"8",per_computing_node_max_mem_size:"",per_storage_node_cpu_cores:"8",per_storage_node_innodb_buffer_pool_size:"",per_storage_node_rocksdb_buffer_pool_size:"",per_storage_node_initial_storage_size:"20",per_storage_node_max_storage_size:"20",nick_name:"",machinelist:[],comp_machinelist:[],node_type:"",shard_name:"",shards:"",computer_user:"",computer_password:"",fullsync_level:"1"}},resetNodeTemp:function(){this.nodetemp={machinelist:[],nodes:"1"}},resetSwitchtemp:function(){this.switchtemp={replica:"",primary_node:"",shard_id:"-1",cluster_id:"-1"}},resetRedoTemp:function(){this.redotemp={redolist:[],allow_pull_from_master:"0",allow_replica_delay:"30",need_backup:"0",pv_limit:"10",hdfs_host:""}},handleSwitch:function(){var t=this;this.resetSwitchtemp(),this.dialogSwitchOVisible=!0,p().then((function(e){e.list.length>0&&(t.switchtemp.primary_node=e.list[0].ip+"("+e.list[0].port+")")})),h().then((function(e){if(200==e.code&&(t.options=[],e.list.length>0))for(var s=0;s<e.list.length;s++){var r={value:s,label:e.list[s].ip+"("+e.list[s].port+")"};t.options.push(r)}}))},switchData:function(t){var e=this;this.$refs["switchForm"].validate((function(t){if(t){var s={};s.user_name=sessionStorage.getItem("login_username"),s.job_id="",s.job_type="manual_switch",s.version=c["u"][0].ver,s.timestamp=c["s"][0].time+"";var r=e.switchtemp.primary_node.substring(0,e.switchtemp.primary_node.length-1).replace("(","_"),i={};if(e.switchtemp.replica.length){var a=e.switchtemp.replica.substring(0,e.switchtemp.replica.length-1).replace("(","_");i.shard_id=e.switchtemp.shard_id,i.cluster_id=e.switchtemp.cluster_id,i.master_hostaddr=r,i.assign_hostaddr=a}else i.shard_id=e.switchtemp.shard_id,i.cluster_id=e.switchtemp.cluster_id,i.master_hostaddr=r;s.paras=i,Object(l["Fb"])(s).then((function(t){var s=t;if("accept"==s.status){e.dialogSwitchOVisible=!1,e.stepParams=[];var r=0,i="主备切换";e.computer=[],e.shard=[],e.computer_state="",e.storage_state="",e.computer_title="",e.computer_icon="",e.shard_icon="",e.shard_title="",e.comp_active=0,e.shard_active=0,e.strogemachines=[],e.init_title="",e.init_active=0,e.finish_title="",e.finish_icon="",e.finish_description="",e.computer_description="",e.shard_description="",e.job_id="",e.timer=null,e.timer=setInterval((function(){e.getFStatus(e.timer,s.job_id,r++,i,"")}),1e3)}else e.message_tips=s.error_info,e.message_type="error",Object(o["g"])(e.message_tips,e.message_type)}))}}))},change:function(){this.options.length==this.redotemp.redolist.length?this.redotemp.allow_pull_from_master="1":this.redotemp.allow_pull_from_master="0"},handleRedo:function(){var t=this;this.resetRedoTemp(),this.dialogRedoVisible=!0,Object(l["D"])().then((function(e){if(t.hdfs_options=[],null!==e.list)for(var s=0;s<e.list.length;s++){var r={value:s,label:e.list[s].hostaddr+"("+e.list[s].port+")"};t.hdfs_options.push(r)}})),h().then((function(e){if(200==e.code&&(t.options=[],e.list.length>0))for(var s=0;s<e.list.length;s++){var r={value:s,label:e.list[s].ip+"("+e.list[s].port+")"};t.options.push(r)}}))},redoData:function(t){var e=this;this.$refs["redoForm"].validate((function(t){if(t){var s={};s.user_name=sessionStorage.getItem("login_username"),s.job_id="",s.job_type="rebuild_node",s.version=c["u"][0].ver,s.timestamp=c["s"][0].time+"";for(var r=[],i=[],a=0;a<e.redotemp.redolist.length;a++){var n=e.redotemp.redolist[a].substring(0,e.redotemp.redolist[a].length-1).split("("),u="";u=e.redotemp.pv_limit?e.redotemp.pv_limit:"10";var d={};if("1"==e.redotemp.need_backup){var p=e.redotemp.hdfs_host.substring(0,e.redotemp.hdfs_host.length-1).replace("(",":");d.hostaddr=n[0],d.port=n[1],d.need_backup=e.redotemp.need_backup,d.hdfs_host=p,d.pv_limit=u}else d.hostaddr=n[0],d.port=n[1],d.need_backup=e.redotemp.need_backup,d.pv_limit=u;r.push(d),i.push({title:n[0]+"_"+n[1],error_code:"0",error_info:"",status:"no_start",step:""})}var h={};"1"==e.redotemp.allow_pull_from_master?(h.shard_id="-1",h.cluster_id="-1",h.allow_pull_from_master=e.redotemp.allow_pull_from_master,h.rb_nodes=r):(h.shard_id="-1",h.cluster_id="-1",h.allow_pull_from_master=e.redotemp.allow_pull_from_master,h.allow_replica_delay=e.redotemp.allow_replica_delay,h.rb_nodes=r),s.paras=h,e.dialogStatusRedoVisible=!0,e.dialogRedoVisible=!1,Object(l["tb"])(s).then((function(t){var s=t;if("accept"==s.status){e.dialogRedoVisible=!1,e.stepParams=[];var r=0,a="重做备机节点";e.statusList=[],e.timer=null,e.init_active=0,e.second_active=0,e.getFStatus(e.timer,s.job_id,r++,a,i),e.timer=setInterval((function(){e.getFStatus(e.timer,s.job_id,r++,a,i)}),5e3)}else e.message_tips=s.error_info,e.message_type="error",Object(o["g"])(e.message_tips,e.message_type)}))}}))},handleUpdate:function(t){var e=this;this.resetNodeTemp(),this.dialogStatus="update",this.dialogNodeVisible=!0,this.dialogDetail=!1,Object(l["mb"])().then((function(t){e.strogemachines=[],e.strogemachines=t.list})),this.$nextTick((function(){e.$refs["nodeForm"].clearValidate()}))},updateData:function(){var t=this;this.$refs["nodeForm"].validate((function(e){if(e){var s=Object.assign({},t.nodetemp),r=[];s.machinelist.forEach((function(t){r.push(t)})),s.job_id="",s.version=c["u"][0].ver,s.user_name=sessionStorage.getItem("login_username"),s.job_type="add_nodes",s.timestamp=c["s"][0].time+"";var i={cluster_id:"-1"};i.nodes=s.nodes,i.shard_id="-1",r.length>0&&(i.storage_iplists=r),s.paras=i,t.$delete(s,"machinelist"),t.$delete(s,"nodes"),Object(l["g"])(s).then((function(e){var s=e;if("accept"==s.status){t.dialogNodeVisible=!1,t.dialogStatusShowVisible=!0,t.computer=[],t.shard=[],t.computer_state="",t.storage_state="",t.computer_title="",t.computer_icon="",t.shard_icon="",t.shard_title="",t.comp_active=0,t.shard_active=0,t.strogemachines=[],t.init_title="",t.init_active=0,t.finish_title="",t.finish_icon="",t.finish_description="",t.computer_description="",t.shard_description="",t.job_id="",t.timer=null,t.init_show=!0;var r="添加存储节点",i=0;t.getFStatus(t.timer,s.job_id,i++,r,""),t.timer=setInterval((function(){t.getFStatus(t.timer,s.job_id,i++,r,"")}),5e3)}else"ongoing"==s.status?(t.message_tips="系统正在操作中，请等待一会！",t.message_type="error",Object(o["g"])(t.message_tips,t.message_type)):(t.message_tips=s.error_info,t.message_type="error",Object(o["g"])(t.message_tips,t.message_type))}))}}))},handleDelete:function(t){var e=this,s=Object(o["a"])(),r="此操作将永久删除该数据, 是否继续?code="+s;Object(o["e"])(r).then((function(r){if(r.value){if(r.value==s){var i={};i.user_name=sessionStorage.getItem("login_username"),i.job_id="",i.job_type="delete_node",i.version=c["u"][0].ver,i.timestamp=c["s"][0].time+"";var a={cluster_id:"-1",shard_id:"-1"};return a.hostaddr=t.hostaddr,a.port=t.port,i.paras=a,void console.log(i)}e.message_tips="code输入有误",e.message_type="error",Object(o["g"])(e.message_tips,e.message_type)}else e.message_tips="code不能为空！",e.message_type="error",Object(o["g"])(e.message_tips,e.message_type)})).catch((function(){console.log("quxiao"),Object(o["g"])("已取消删除","info")}))},getFStatus:function(t,e,s,r,i){var a=this;setTimeout((function(){var n={job_type:"get_status"};n.version=c["u"][0].ver,n.job_id=e,n.timestamp=c["s"][0].time+"",n.paras={},a.job_id="任务ID:"+e,Object(l["Q"])(n).then((function(e){if("添加shard"==r||"添加计算节点"==r||"添加存储节点"==r)if(null!==e.attachment){if("添加shard"==r||"添加存储节点"==r?(a.shard_show=!0,a.init_show=!1,a.computer_show=!1):"添加计算节点"==r&&(a.shard_show=!1,a.init_show=!1,a.computer_show=!0),e.attachment.hasOwnProperty("computer_state"))if("ongoing"==e.attachment.computer_state)a.computer_state="process",a.computer_icon="el-icon-loading",a.computer_title="正在"+r;else if("done"==e.attachment.computer_state){if(a.computer_state="success",a.computer_icon="el-icon-circle-check",a.computer_title=r+"成功",a.computer.length>0)for(var n=0;n<a.computer.length;n++)for(var c=e.attachment.computer_hosts.substr(0,e.attachment.computer_hosts.length-1),l=c.split(";"),u=0;u<l.length;u++)a.computer[n].title==l[u]&&(a.computer[n].icon="el-icon-circle-check",a.computer[n].status="success")}else if("failed"==e.attachment.computer_state){if(a.computer_state="error",a.computer_icon="el-icon-circle-close",a.computer_title=r+"失败",a.computer.length>0){for(var d=0;d<a.computer.length;d++)for(var p=e.attachment.computer_hosts.substr(0,e.attachment.computer_hosts.length-1),h=p.split(";"),m=0;m<h.length;m++)a.computer[d].title==h[m]&&(a.computer[d].icon="el-icon-circle-close",a.computer[d].status="error");a.computer_description=e.error_info}}else a.computer_state="process",a.computer_icon="el-icon-loading",a.computer_title="正在"+r;if(e.attachment.hasOwnProperty("storage_state"))if("ongoing"==e.attachment.storage_state)a.storage_state="process",a.shard_icon="el-icon-loading",a.shard_title="正在"+r;else if("done"==e.attachment.storage_state){if(a.storage_state="success",a.shard_icon="el-icon-circle-check",a.shard_title=r+"成功",a.shard.length>0)for(var _=0;_<a.shard.length;_++){var f="";f="添加shard"==r?e.attachment.shard_ids:e.attachment.shard_hosts;for(var g=0;g<f.length;g++)for(var b in f[g]){var v=f[g][b];a.shard[_].shard_id==v&&(a.shard[_].icon="el-icon-circle-check",a.shard[_].status="success")}}}else if("failed"==e.attachment.storage_state){if(a.storage_state="error",a.shard_icon="el-icon-circle-close",a.shard_title=r+"失败",a.shard.length>0){for(var L=0;L<a.shard.length;L++){var w="";w="添加shard"==r?e.attachment.shard_ids:e.attachment.shard_hosts;for(var j=0;j<w.length;j++)for(var b in w[j]){v=w[j][b];a.shard[L].shard_id==v&&(a.shard[L].icon="el-icon-circle-close",a.shard[L].status="error")}}a.shard_description=e.error_info}}else a.storage_state="process",a.shard_icon="el-icon-loading",a.shard_title="正在"+r;if(a.init_title="正在"+r,a.init_active=1,0==a.computer.length||0==a.shard.length){if(0==a.computer.length&&e.attachment.hasOwnProperty("computer_hosts")){var O=e.attachment.computer_hosts.substr(0,e.attachment.computer_hosts.length-1),k=O.split(";");if("done"==e.attachment.computer_state)for(var C=0;C<k.length;C++){var y={};y.title=k[C],y.icon="el-icon-circle-check",y.status="success",y.description="",y.computer_id=e.attachment.computer_id,a.computer.push(y)}else for(var S=0;S<k.length;S++){var x={};x.title=k[S],x.icon="el-icon-loading",x.status="process",x.description="",x.computer_id=e.attachment.computer_id,a.computer.push(x)}}if(0==a.shard.length&&e.attachment.hasOwnProperty("shard_hosts")){var I="";I="添加shard"==r?e.attachment.shard_ids:e.attachment.shard_hosts;for(var P=0;P<I.length;P++)for(var b in I[P]){var V={};v=I[P][b];console.log(v);var $=b+":"+v;V.title=""!==v?$:"正在"+r,V.icon="el-icon-loading",V.status="process",V.description="",V.shard_id=v,a.shard.push(V)}}if("failed"==e.status){if(a.storage_state="error",a.shard_icon="el-icon-circle-close",a.shard_title=r+"失败",a.init_show=!1,a.computer_state="error",a.computer_icon="el-icon-circle-close",a.computer_title=r+"失败",a.finish_title=r+"失败",a.finish_icon="el-icon-circle-close",a.init_active=1,a.finish_description=e.error_info,a.computer.length>0){for(var N=0;N<a.computer.length;N++)if(e.attachment.hasOwnProperty("computer_hosts"))for(var D=e.attachment.computer_hosts.substr(0,e.attachment.computer_hosts.length-1),T=D.split(";"),M=0;M<T.length;M++)a.computer[N].title==T[M]&&(a.computer[N].icon="el-icon-circle-close",a.computer[N].status="error");a.computer_description=e.error_info}if(a.shard.length>0){for(var F=0;F<a.shard.length;F++){var z="";if(e.attachment.hasOwnProperty("shard_hosts")){z="添加shard"==r?e.attachment.shard_ids:e.attachment.shard_hosts;for(var R=0;R<z.length;R++)for(var b in z[R]){v=z[R][b];a.shard[F].shard_id==v&&(a.shard[F].icon="el-icon-circle-close",a.shard[F].status="error")}}}a.shard_description=e.error_info}clearInterval(t)}else if("done"==e.status){if(a.storage_state="success",a.shard_icon="el-icon-circle-check",a.shard_title=r+"成功",a.computer_state="success",a.computer_icon="el-icon-circle-check",a.computer_title=r+"成功",a.finish_title=r+"成功",a.finish_icon="el-icon-circle-check",a.init_active=1,a.finish_description=e.error_info,a.computer.length>0)for(var E=0;E<a.computer.length;E++)if(e.attachment.hasOwnProperty("computer_hosts"))for(var B=e.attachment.computer_hosts.substr(0,e.attachment.computer_hosts.length-1),Q=B.split(";"),A=0;A<Q.length;A++)a.computer[E].title==Q[A]&&(a.computer[E].icon="el-icon-circle-check",a.computer[E].status="success");if(a.shard.length>0)for(var q=0;q<a.shard.length;q++){var J="";if(e.attachment.hasOwnProperty("shard_hosts")){J="添加shard"==r?e.attachment.shard_ids:e.attachment.shard_hosts;for(var U=0;U<J.length;U++)for(var b in J[U]){v=J[U][b];a.shard[q].shard_id==v&&(a.shard[q].icon="el-icon-circle-check",a.shard[q].status="success")}}}clearInterval(t),a.getList()}}}else null==e.attachment&&"70001"==e.error_code&&"failed"==e.status?"添加shard"==r||"添加存储节点"==r?(a.shard_show=!0,a.init_show=!1,a.computer_show=!1,a.storage_state="process",a.shard_icon="el-icon-loading",a.shard_title="正在"+r,s>5&&(a.storage_state="error",a.shard_icon="el-icon-circle-close",a.shard_title=r+"失败",clearInterval(t))):"添加计算节点"==r&&(a.shard_show=!1,a.init_show=!1,a.computer_show=!0,a.computer_state="process",a.computer_icon="el-icon-loading",a.computer_title="正在"+r,s>5&&(a.computer_state="error",a.computer_icon="el-icon-circle-close",a.computer_title=r+"失败",clearInterval(t))):null==e.attachment&&"ongoing"==e.status?"添加shard"==r||"添加存储节点"==r?(a.shard_show=!0,a.init_show=!1,a.computer_show=!1,a.storage_state="process",a.shard_icon="el-icon-loading",a.shard_title="正在"+r):"添加计算节点"==r&&(a.shard_show=!1,a.init_show=!1,a.computer_show=!0,a.computer_state="process",a.computer_icon="el-icon-loading",a.computer_title="正在"+r):null==e.attachment&&"done"==e.status?("添加shard"==r||"添加存储节点"==r?(a.shard_show=!0,a.init_show=!1,a.computer_show=!1,a.storage_state="success",a.shard_icon="el-icon-circle-check",a.shard_title=r+"成功"):"添加计算节点"==r&&(a.shard_show=!1,a.init_show=!1,a.computer_show=!0,a.computer_state="success",a.computer_icon="el-icon-circle-check",a.computer_title=r+"成功"),clearInterval(t)):("添加shard"==r||"添加存储节点"==r?(a.shard_show=!0,a.init_show=!1,a.computer_show=!1,a.storage_state="error",a.shard_icon="el-icon-circle-close",a.shard_title=r+"失败"):"添加计算节点"==r&&(a.shard_show=!1,a.init_show=!1,a.computer_show=!0,a.computer_state="error",a.computer_icon="el-icon-circle-close",a.computer_title=r+"失败"),clearInterval(t));else if("扩容"==r)null!==e.attachment?"failed"==e.status?(a.expand_end="集群扩容失败",a.expondInit=!1,a.expondSatus=!0,a.expondResult=!0,a.expondInfo=e.attachment.memo_info,console.log(e.attachment.memo_info),clearInterval(t)):"done"==e.status?(a.expand_end="集群扩容成功",a.expondInit=!1,a.expondSatus=!0,a.expondResult=!0,a.expondInfo=e.attachment.memo_info,clearInterval(t)):(a.expand_init="正在进行集群扩容",a.expondInit=!0,a.expondSatus=!1,a.expondResult=!1,a.expondInfo=e.attachment.memo_info):null==e.attachment&&"failed"==e.status&&(a.expondInit=!1,a.expondSatus=!1,a.expondResult=!0,a.expand_end="集群扩容失败",clearInterval(t));else if("主备切换"==r)if(null!==e.attachment){a.dialogStatusFVisible=!0;var H=e.attachment.job_step.replace(/\s+/g,"").split(",");if(0==a.stepParams.length)for(var W=0;W<H.length;W++){var K={};if(0==W?(K.title=H[W],K.icon="el-icon-loading",K.status="process",K.description=""):(K.title=H[W],K.icon="",K.status="wait",K.description=""),e.attachment.step==H[W]){if(W>a.active)for(var G=0;G<a.stepParams.length;G++)if(G==W&&"wait"==a.stepParams[G].status&&(a.stepParams[G].icon="el-icon-loading",a.stepParams[G].status="process"),G>0&&G<W)for(var Y=0;Y<G;Y++)a.stepParams[Y].icon="el-icon-circle-check",a.stepParams[Y].status="success";a.active=W}a.stepParams.push(K)}else if("ongoing"==e.status){for(var X=0;X<a.stepParams.length;X++)if(e.attachment.step==a.stepParams[X].title&&(a.active=X,a.stepParams[X].icon="el-icon-loading",a.stepParams[X].status="process",X>0&&X<a.active+1))for(var Z=0;Z<X;Z++)a.stepParams[Z].icon="el-icon-circle-check",a.stepParams[Z].status="success"}else if("done"==e.status){for(var tt=0;tt<a.stepParams.length;tt++)a.active=a.stepParams.length,a.stepParams[tt].icon="el-icon-circle-check",a.stepParams[tt].status="success";clearInterval(t)}else if("failed"==e.status){for(var et=0;et<a.stepParams.length;et++)"process"==a.stepParams[et].status&&(a.active=et,a.stepParams[et].icon="el-icon-circle-close",a.stepParams[et].status="error",a.stepParams[et].description=e.error_info);clearInterval(t)}}else null==e.attachment&&"70001"==e.error_code&&"failed"==e.status&&s>5&&clearInterval(t);else if("重做备机节点"==r)if(null!==e.attachment)if(0==a.statusList.length){var st={};if("failed"==e.status)st={title:r+"失败",icon:"el-icon-circle-close",status:"error",description:e.error_code,second:[]},a.statusList.push(st),clearInterval(t);else for(var rt=0;rt<i.length;rt++){for(var it=e.attachment.job_step.replace(/\s+/g,"").split(","),at={},ot=[],nt=0;nt<it.length;nt++)at={title:it[nt],icon:"",status:"wait",description:""},ot.push(at);if(0==rt){if(st={title:i[rt].title,icon:"el-icon-loading",status:"process",description:"",second:ot},a.statusList.push(st),"done"==i[rt].status){a.init_active=rt+1,a.statusList[rt].icon="el-icon-circle-check",a.statusList[rt].status="success";for(var ct=0;ct<a.statusList[rt].second.length;ct++)a.statusList[rt].second[ct].icon="el-icon-circle-check",a.statusList[rt].second[ct].status="success"}else if("ongoing"==i[rt].status){a.init_active=rt,a.statusList[rt].icon="el-icon-loading",a.statusList[rt].status="process";for(var lt=0;lt<a.statusList[rt].second.length;lt++)if(i[rt].step==a.statusList[rt].second[lt].title){a.statusList[rt].second[lt].icon="el-icon-loading",a.statusList[rt].second[lt].status="process";for(var ut=0;ut<lt;ut++)a.statusList[rt].second[ut].icon="el-icon-circle-check",a.statusList[rt].second[ut].status="success"}}else if("failed"==i[rt].status){a.statusList[rt].icon="el-icon-circle-close",a.statusList[rt].status="error";for(var dt=0;dt<a.statusList[rt].second.length;dt++)if(i[rt].step==a.statusList[rt].second[dt].title){a.statusList[rt].second[dt].icon="el-icon-circle-close",a.statusList[rt].second[dt].status="error";for(var pt=0;pt<dt;pt++)a.statusList[rt].second[pt].icon="el-icon-circle-check",a.statusList[rt].second[pt].status="success"}a.statusList[rt].description=i[rt].error_info}}else{for(var ht=e.attachment.job_step.replace(/\s+/g,"").split(","),mt={},_t=[],ft=0;ft<ht.length;ft++)mt={title:ht[ft],icon:"",status:"wait",description:""},_t.push(mt);if(0==a.init_active?(st={title:i[rt].title,icon:"",status:"wait",description:"",second:_t},a.statusList.push(st)):(st={title:i[rt].title,icon:"el-icon-loading",status:"process",description:"",second:_t},a.statusList.push(st)),"done"==i[rt].status){a.init_active=rt+1,a.statusList[rt].icon="el-icon-circle-check",a.statusList[rt].status="success";for(var gt=0;gt<a.statusList[rt].second.length;gt++)a.statusList[rt].second[gt].icon="el-icon-circle-check",a.statusList[rt].second[gt].status="success"}else if("ongoing"==i[rt].status){a.init_active=rt,a.statusList[rt].icon="el-icon-loading",a.statusList[rt].status="process";for(var bt=0;bt<a.statusList[rt].second.length;bt++)if(i[rt].step==a.statusList[rt].second[bt].title){a.statusList[rt].second[bt].icon="el-icon-loading",a.statusList[rt].second[bt].status="process";for(var vt=0;vt<bt;vt++)a.statusList[rt].second[vt].icon="el-icon-circle-check",a.statusList[rt].second[vt].status="success"}}else if("failed"==i[rt].status){a.statusList[rt].icon="el-icon-circle-close",a.statusList[rt].status="error";for(var Lt=0;Lt<a.statusList[rt].second.length;Lt++)if(i[rt].step==a.statusList[rt].second[Lt].title){a.statusList[rt].second[Lt].icon="el-icon-circle-close",a.statusList[rt].second[Lt].status="error";for(var wt=0;wt<Lt;wt++)a.statusList[rt].second[wt].icon="el-icon-circle-check",a.statusList[rt].second[wt].status="success"}a.statusList[rt].description=i[rt].error_info}}}}else if("ongoing"==e.status){var jt=[];for(var Ot in e.attachment)if("job_step"!==Ot){var kt=e.attachment[Ot];a.$set(kt,"title",Ot),jt.push(kt)}for(var Ct=0;Ct<jt.length;Ct++)if(0==Ct){if("done"==jt[Ct].status){a.init_active=Ct+1,a.statusList[Ct].icon="el-icon-circle-check",a.statusList[Ct].status="success";for(var yt=0;yt<a.statusList[Ct].second.length;yt++)a.statusList[Ct].second[yt].icon="el-icon-circle-check",a.statusList[Ct].second[yt].status="success"}else if("ongoing"==jt[Ct].status){a.init_active=Ct,a.statusList[Ct].icon="el-icon-loading",a.statusList[Ct].status="process";for(var St=0;St<a.statusList[Ct].second.length;St++)if(jt[Ct].step==a.statusList[Ct].second[St].title){a.statusList[Ct].second[St].icon="el-icon-loading",a.statusList[Ct].second[St].status="process";for(var xt=0;xt<St;xt++)a.statusList[Ct].second[xt].icon="el-icon-circle-check",a.statusList[Ct].second[xt].status="success"}}else if("failed"==jt[Ct].status){a.statusList[Ct].icon="el-icon-circle-close",a.statusList[Ct].status="error";for(var It=0;It<a.statusList[Ct].second.length;It++)if(jt[Ct].step==a.statusList[Ct].second[It].title){a.statusList[Ct].second[It].icon="el-icon-circle-close",a.statusList[Ct].second[It].status="error";for(var Pt=0;Pt<It;Pt++)a.statusList[Ct].second[Pt].icon="el-icon-circle-check",a.statusList[Ct].second[Pt].status="success"}a.statusList[Ct].description=jt[Ct].error_info}}else if("done"==jt[Ct].status){a.init_active=Ct+1,a.statusList[Ct].icon="el-icon-circle-check",a.statusList[Ct].status="success";for(var Vt=0;Vt<a.statusList[Ct].second.length;Vt++)a.statusList[Ct].second[Vt].icon="el-icon-circle-check",a.statusList[Ct].second[Vt].status="success"}else if("ongoing"==jt[Ct].status){a.init_active=Ct,a.statusList[Ct].icon="el-icon-loading",a.statusList[Ct].status="process";for(var $t=0;$t<a.statusList[Ct].second.length;$t++)if(jt[Ct].step==a.statusList[Ct].second[$t].title){a.statusList[Ct].second[$t].icon="el-icon-loading",a.statusList[Ct].second[$t].status="process";for(var Nt=0;Nt<$t;Nt++)a.statusList[Ct].second[Nt].icon="el-icon-circle-check",a.statusList[Ct].second[Nt].status="success"}}else if("failed"==jt[Ct].status){a.statusList[Ct].icon="el-icon-circle-close",a.statusList[Ct].status="error";for(var Dt=0;Dt<a.statusList[Ct].second.length;Dt++)if(jt[Ct].step==a.statusList[Ct].second[Dt].title){a.statusList[Ct].second[Dt].icon="el-icon-circle-close",a.statusList[Ct].second[Dt].status="error";for(var Tt=0;Tt<Dt;Tt++)a.statusList[Ct].second[Tt].icon="el-icon-circle-check",a.statusList[Ct].second[Tt].status="success"}a.statusList[Ct].description=jt[Ct].error_info}}else if("failed"==e.status){var Mt=[];for(var Ft in e.attachment)if("job_step"!==Ft){var zt=e.attachment[Ft];a.$set(zt,"title",Ft),Mt.push(zt)}for(var Rt=0;Rt<Mt.length;Rt++)if(0==Rt){if("done"==Mt[Rt].status){a.init_active=Rt+1,a.statusList[Rt].icon="el-icon-circle-check",a.statusList[Rt].status="success";for(var Et=0;Et<a.statusList[Rt].second.length;Et++)a.statusList[Rt].second[Et].icon="el-icon-circle-check",a.statusList[Rt].second[Et].status="success"}else if("ongoing"==Mt[Rt].status){a.init_active=Rt,a.statusList[Rt].icon="el-icon-loading",a.statusList[Rt].status="process";for(var Bt=0;Bt<a.statusList[Rt].second.length;Bt++)if(Mt[Rt].step==a.statusList[Rt].second[Bt].title){a.statusList[Rt].second[Bt].icon="el-icon-loading",a.statusList[Rt].second[Bt].status="process";for(var Qt=0;Qt<Bt;Qt++)a.statusList[Rt].second[Qt].icon="el-icon-circle-check",a.statusList[Rt].second[Qt].status="success"}}else if("failed"==Mt[Rt].status){a.statusList[Rt].icon="el-icon-circle-close",a.statusList[Rt].status="error";for(var At=0;At<a.statusList[Rt].second.length;At++)if(Mt[Rt].step==a.statusList[Rt].second[At].title){a.statusList[Rt].second[At].icon="el-icon-circle-close",a.statusList[Rt].second[At].status="error";for(var qt=0;qt<At;qt++)a.statusList[Rt].second[qt].icon="el-icon-circle-check",a.statusList[Rt].second[qt].status="success"}a.statusList[Rt].description=Mt[Rt].error_info}}else if("done"==Mt[Rt].status){a.init_active=Rt+1,a.statusList[Rt].icon="el-icon-circle-check",a.statusList[Rt].status="success";for(var Jt=0;Jt<a.statusList[Rt].second.length;Jt++)a.statusList[Rt].second[Jt].icon="el-icon-circle-check",a.statusList[Rt].second[Jt].status="success"}else if("ongoing"==Mt[Rt].status){a.init_active=Rt,a.statusList[Rt].icon="el-icon-loading",a.statusList[Rt].status="process";for(var Ut=0;Ut<a.statusList[Rt].second.length;Ut++)if(Mt[Rt].step==a.statusList[Rt].second[Ut].title){a.statusList[Rt].second[Ut].icon="el-icon-loading",a.statusList[Rt].second[Ut].status="process";for(var Ht=0;Ht<Ut;Ht++)a.statusList[Rt].second[Ht].icon="el-icon-circle-check",a.statusList[Rt].second[Ht].status="success"}}else if("failed"==Mt[Rt].status){a.statusList[Rt].icon="el-icon-circle-close",a.statusList[Rt].status="error";for(var Wt=0;Wt<a.statusList[Rt].second.length;Wt++)if(Mt[Rt].step==a.statusList[Rt].second[Wt].title){a.statusList[Rt].second[Wt].icon="el-icon-circle-close",a.statusList[Rt].second[Wt].status="error";for(var Kt=0;Kt<Wt;Kt++)a.statusList[Rt].second[Kt].icon="el-icon-circle-check",a.statusList[Rt].second[Kt].status="success"}a.statusList[Rt].description=Mt[Rt].error_info}var Gt={title:r+"失败",icon:"el-icon-circle-close",status:"error",description:e.error_info,second:""};a.statusList.push(Gt),clearInterval(t)}else if("done"==e.status){var Yt=[];for(var Xt in e.attachment)if("job_step"!==Xt){var Zt=e.attachment[Xt];a.$set(Zt,"title",Xt),Yt.push(Zt)}for(var te=0;te<Yt.length;te++)if(0==te){if("done"==Yt[te].status){a.init_active=te+1,a.statusList[te].icon="el-icon-circle-check",a.statusList[te].status="success";for(var ee=0;ee<a.statusList[te].second.length;ee++)a.statusList[te].second[ee].icon="el-icon-circle-check",a.statusList[te].second[ee].status="success"}else if("ongoing"==Yt[te].status){a.init_active=te,a.statusList[te].icon="el-icon-loading",a.statusList[te].status="process";for(var se=0;se<a.statusList[te].second.length;se++)if(Yt[te].step==a.statusList[te].second[se].title){a.statusList[te].second[se].icon="el-icon-loading",a.statusList[te].second[se].status="process";for(var re=0;re<se;re++)a.statusList[te].second[re].icon="el-icon-circle-check",a.statusList[te].second[re].status="success"}}else if("failed"==Yt[te].status){a.statusList[te].icon="el-icon-circle-close",a.statusList[te].status="error";for(var ie=0;ie<a.statusList[te].second.length;ie++)if(Yt[te].step==a.statusList[te].second[ie].title){a.statusList[te].second[ie].icon="el-icon-circle-close",a.statusList[te].second[ie].status="error";for(var ae=0;ae<ie;ae++)a.statusList[te].second[ae].icon="el-icon-circle-check",a.statusList[te].second[ae].status="success"}a.statusList[te].description=Yt[te].error_info}}else if("done"==Yt[te].status){a.init_active=te+1,a.statusList[te].icon="el-icon-circle-check",a.statusList[te].status="success";for(var oe=0;oe<a.statusList[te].second.length;oe++)a.statusList[te].second[oe].icon="el-icon-circle-check",a.statusList[te].second[oe].status="success"}else if("ongoing"==Yt[te].status){a.init_active=te,a.statusList[te].icon="el-icon-loading",a.statusList[te].status="process";for(var ne=0;ne<a.statusList[te].second.length;ne++)if(Yt[te].step==a.statusList[te].second[ne].title){a.statusList[te].second[ne].icon="el-icon-loading",a.statusList[te].second[ne].status="process";for(var ce=0;ce<ne;ce++)a.statusList[te].second[ce].icon="el-icon-circle-check",a.statusList[te].second[ce].status="success"}}else if("failed"==Yt[te].status){a.statusList[te].icon="el-icon-circle-close",a.statusList[te].status="error";for(var le=0;le<a.statusList[te].second.length;le++)if(Yt[te].step==a.statusList[te].second[le].title){a.statusList[te].second[le].icon="el-icon-circle-close",a.statusList[te].second[le].status="error";for(var ue=0;ue<le;ue++)a.statusList[te].second[ue].icon="el-icon-circle-check",a.statusList[te].second[ue].status="success"}a.statusList[te].description=Yt[te].error_info}var de={title:r+"成功",icon:"el-icon-circle-check",status:"success",description:"",second:""};a.statusList.push(de),clearInterval(t)}else a.message_tips=e.error_info,a.message_type="error",Object(o["g"])(a.message_tips,a.message_type);else if(null==e.attachment&&"70001"==e.error_code&&"failed"==e.status){if(s>5){var pe={title:r+"失败",icon:"el-icon-circle-close",status:"error",description:e.error_code,second:[]};a.statusList.push(pe),clearInterval(t)}}else if(null==e.attachment&&"ongoing"==e.status){a.statusList=[];var he={};he={title:"正在"+r,icon:"el-icon-loading",status:"process",description:"",second:[]},a.statusList.push(he)}else if(null==e.attachment&&"done"==e.status){a.statusList=[];var me={};me={title:r+"成功",icon:"el-icon-circle-check",status:"success",description:"",second:[]},a.statusList.push(me),clearInterval(t)}else{a.statusList=[];var _e={};_e={title:r+"失败",icon:"el-icon-circle-close",status:"error",description:e.error_code,second:[]},a.statusList.push(_e),clearInterval(t)}else if("删除存储节点"==r)if(null!==e.attachment){if("删除存储节点"==r&&(a.shard_show=!0,a.init_show=!1,a.computer_show=!1,console.log(10)),"ongoing"==e.attachment.storage_state?(a.storage_state="process",a.shard_icon="el-icon-loading",a.shard_title="正在"+r):"done"==e.attachment.storage_state?(console.log(4),a.storage_state="success",a.shard_icon="el-icon-circle-check",a.shard_title=r+"成功"):"failed"==e.attachment.storage_state?(console.log(5),a.storage_state="error",a.shard_icon="el-icon-circle-close",a.shard_title=r+"失败"):(console.log(6),a.storage_state="process",a.shard_icon="el-icon-loading",a.shard_title="正在"+r),a.init_title="正在"+r,a.init_active=1,0==a.computer.length||0==a.shard.length){if(1==a.computer_show&&0==a.computer.length){console.log(1);var fe={};if(e.attachment.hasOwnProperty("computer_hosts"))for(var ge=e.attachment.computer_hosts.substr(0,e.attachment.computer_hosts.length-1),be=ge.split(";"),ve=0;ve<be.length;ve++)"done"==e.attachment.computer_state?(fe.title=!0===e.attachment.hasOwnProperty("computer_hosts")?be[ve]:"正在"+r,fe.icon="el-icon-circle-check",fe.status="success",fe.description="",fe.computer_id=e.attachment.computer_id,a.computer.push(fe)):"failed"==e.attachment.computer_state?(fe.title=!0===e.attachment.hasOwnProperty("computer_hosts")?be[ve]:"正在"+r,fe.icon="el-icon-circle-close",fe.status="error",fe.description=e.error_info,fe.computer_id=e.attachment.computer_id,a.computer.push(fe)):(fe.title=!0===e.attachment.hasOwnProperty("computer_hosts")?be[ve]:"正在"+r,fe.icon="el-icon-loading",fe.status="process",fe.description="",fe.computer_id=e.attachment.computer_id,a.computer.push(fe))}if(1==a.shard_show&&0==a.shard.length&&(console.log(2),e.attachment.hasOwnProperty("storage_state")))if("done"==e.attachment.storage_state){var Le="";console.log(3),Le=e.attachment.shard_id;var we={};we.title=""!==Le?Le:"正在"+r,we.icon="el-icon-circle-check",we.status="success",we.description="",we.shard_id=v,a.shard.push(we)}else if("failed"==e.attachment.storage_state){var je="";je=e.attachment.shard_id;var Oe={};Oe.title=""!==je?je:"正在"+r,Oe.icon="el-icon-circle-close",Oe.status="error",Oe.description=e.error_info,Oe.shard_id=v,a.shard.push(Oe)}else{var ke="";ke=e.attachment.shard_id;var Ce={};Ce.title=""!==ke?ke:"正在"+r,Ce.icon="el-icon-loading",Ce.status="process",Ce.description="",Ce.shard_id=ke,a.shard.push(Ce)}if("failed"==e.status){if(console.log(7),a.storage_state="error",a.shard_icon="el-icon-circle-close",a.shard_title=r+"失败",a.init_show=!1,a.finish_title=r+"失败",a.finish_icon="el-icon-circle-close",a.init_active=1,a.finish_description=e.error_info,a.shard.length>0){for(var ye=0;ye<a.shard.length;ye++){var Se="";Se=e.attachment.shard_id,a.shard[ye].shard_id==Se&&(a.shard[ye].icon="el-icon-circle-close",a.shard[ye].status="error")}a.shard_description=e.error_info}clearInterval(t)}else if("done"==e.status){if(console.log(8),a.storage_state="success",a.shard_icon="el-icon-circle-check",a.shard_title=r+"成功",a.finish_title=r+"成功",a.finish_icon="el-icon-circle-check",a.init_active=1,a.finish_description=e.error_info,a.shard.length>0){console.log(9);for(var xe=0;xe<a.shard.length;xe++){var Ie="";Ie=e.attachment.shard_id,a.shard[xe].shard_id==Ie&&(a.shard[xe].icon="el-icon-circle-check",a.shard[xe].status="success")}}clearInterval(t),a.getCluster()}}}else null==e.attachment&&"70001"==e.error_code&&"failed"==e.status?"删除存储节点"==r&&(a.shard_show=!0,a.init_show=!1,a.computer_show=!1,a.storage_state="process",a.shard_icon="el-icon-loading",a.shard_title="正在"+r,s>5&&(a.storage_state="error",a.shard_icon="el-icon-circle-close",a.shard_title=r+"失败",clearInterval(t))):null==e.attachment&&"ongoing"==e.status?"删除存储节点"==r&&(a.shard_show=!0,a.init_show=!1,a.computer_show=!1,a.storage_state="process",a.shard_icon="el-icon-loading",a.shard_title="正在"+r):null==e.attachment&&"done"==e.status?("删除存储节点"==r&&(a.shard_show=!0,a.init_show=!1,a.computer_show=!1,a.storage_state="success",a.shard_icon="el-icon-circle-check",a.shard_title=r+"成功"),clearInterval(t)):("删除存储节点"==r&&(a.shard_show=!0,a.init_show=!1,a.computer_show=!1,a.storage_state="error",a.shard_icon="el-icon-circle-close",a.shard_title=r+"失败"),clearInterval(t))})),s>=86400&&clearInterval(t)}),0)},getStatus:function(t,e,s){var r=this;setTimeout((function(){var i={job_type:"get_status"};i.version=c["u"][0].ver,i.job_id=e,i.timestamp=c["s"][0].time+"",i.paras={},Object(l["Q"])(i).then((function(e){var s="";if(null!==e.attachment&&(s=""!==e.attachment.memo_info.error_info?e.attachment.memo_info.error_info:e.error_info),"done"==e.status||"failed"==e.status)if(clearInterval(t),"done"==e.status){var i={content:"集群回档成功",timestamp:Object(o["d"])(),color:"#0bbd87",icon:"el-icon-circle-check"};r.activities.push(i),r.getList()}else{var a={content:s,timestamp:Object(o["d"])(),color:"red",icon:"el-icon-circle-close"};r.activities.push(a)}else if(s){var n={content:s,timestamp:Object(o["d"])(),color:"#0bbd87"};r.activities.push(n)}})),s>=86400&&clearInterval(t)}),0)}}},g=f,b=(s("0ac5"),s("ddd0"),s("2877")),v=Object(b["a"])(g,r,i,!1,null,"412dca4d",null);e["default"]=v.exports},ed08:function(t,e,s){"use strict";s.d(e,"g",(function(){return i})),s.d(e,"f",(function(){return a})),s.d(e,"b",(function(){return o})),s.d(e,"d",(function(){return n})),s.d(e,"c",(function(){return c})),s.d(e,"a",(function(){return l})),s.d(e,"e",(function(){return u}));s("53ca"),s("ac1f"),s("00b4"),s("5319"),s("4d63"),s("2c3e"),s("25f0"),s("d3b7"),s("4d90"),s("159b"),s("b64b");var r=s("5c96");function i(t,e){return Object(r["Message"])({message:t,type:e,duration:2e3})}function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"确定执行此操作吗？",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"warning";return r["MessageBox"].confirm(t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:e,center:!0})}function o(t){var e=t.split("T");return e[0]+" "+e[1]}function n(){var t=new Date,e="-",s=":",r=t.getFullYear(),i=t.getMonth()+1,a=t.getDate(),o=t.getHours(),n=t.getMinutes(),c=t.getSeconds(),l=["星期一","星期二","星期三","星期四","星期五","星期六","星期天"];l[t.getDay()];i>=1&&i<=9&&(i="0"+i),a>=0&&a<=9&&(a="0"+a),o>=0&&o<=9&&(o="0"+o),n>=0&&n<=9&&(n="0"+n),c>=0&&c<=9&&(c="0"+c);var u=r+e+i+e+a+" "+o+s+n+s+c;return u}function c(t){var e=t.split("-"),s=e[0],r=e[1],i=e[2],a=new Date(s,r,0);a=a.getDate();var o=s,n=parseInt(r)+1;13==n&&(o=parseInt(o)+1,n=1);var c=i,l=new Date(o,n,0);l=l.getDate(),c>l&&(c=l),n<10&&(n="0"+n);var u=o+"-"+n+"-"+c;return u}function l(){for(var t="",e=4,s=new Array(0,1,2,3,4,5,6,7,8,9),r=0;r<e;r++){var i=Math.floor(9*Math.random());t+=s[i]}return t}function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"确定执行此操作吗？",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"warning";return r["MessageBox"].prompt(t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"请输入code",inputPattern:/^[0-9]\d*$/,inputErrorMessage:"code格式不正确",type:e})}}}]);